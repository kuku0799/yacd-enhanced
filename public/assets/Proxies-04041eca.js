import{r as S,R as k,p as x,b as s,j as u,B as T,x as R,a2 as ft,a3 as mt,a4 as Be,a5 as vt,d as B,c as j,a6 as yt,N as M,a7 as gt,a8 as Fe,a9 as ve,Q as Ge,L as _t,E as V,aa as bt,ab as wt,ac as Q,O as xt,ad as Ie,ae as ye,af as ge,ag as Ct,ah as kt,u as ne,ai as Nt,aj as We,ak as Ot,g as _e,C as Ue,S as Oe,al as Pt,a0 as be,am as Tt,an as Et,ao as $t,ap as St,aq as Rt,ar as Lt,as as Mt,at as zt,au as qe,av as Pe,aw as At,ax as jt}from"./index-4815ec65.js";import{C as ue,B as ae}from"./BaseModal-12e3a869.js";import{F as Dt,p as Bt,A as Ft,I as Gt}from"./Fab-0524ec18.js";import{R as It,T as Wt}from"./TextFitler-4c92fdc3.js";import{f as Ut}from"./index-84fa0cb3.js";import{R as qt}from"./rotate-cw-6d1271ce.js";import{S as Ht}from"./Select-ee2beebf.js";import"./debounce-c1ba2006.js";function de(){return de=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])}return e},de.apply(this,arguments)}function Kt(e,r){if(e==null)return{};var n=Vt(e,r),t,o;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)t=a[o],!(r.indexOf(t)>=0)&&Object.prototype.propertyIsEnumerable.call(e,t)&&(n[t]=e[t])}return n}function Vt(e,r){if(e==null)return{};var n={},t=Object.keys(e),o,a;for(a=0;a<t.length;a++)o=t[a],!(r.indexOf(o)>=0)&&(n[o]=e[o]);return n}var we=S.forwardRef(function(e,r){var n=e.color,t=n===void 0?"currentColor":n,o=e.size,a=o===void 0?24:o,c=Kt(e,["color","size"]);return k.createElement("svg",de({ref:r,xmlns:"http://www.w3.org/2000/svg",width:a,height:a,viewBox:"0 0 24 24",fill:"none",stroke:t,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},c),k.createElement("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),k.createElement("polyline",{points:"14 2 14 8 20 8"}),k.createElement("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),k.createElement("line",{x1:"16",y1:"17",x2:"8",y2:"17"}),k.createElement("polyline",{points:"10 9 9 9 8 9"}))});we.propTypes={color:x.string,size:x.oneOfType([x.string,x.number])};we.displayName="FileText";const Yt=we;function pe(){return pe=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])}return e},pe.apply(this,arguments)}function Zt(e,r){if(e==null)return{};var n=Jt(e,r),t,o;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)t=a[o],!(r.indexOf(t)>=0)&&Object.prototype.propertyIsEnumerable.call(e,t)&&(n[t]=e[t])}return n}function Jt(e,r){if(e==null)return{};var n={},t=Object.keys(e),o,a;for(a=0;a<t.length;a++)o=t[a],!(r.indexOf(o)>=0)&&(n[o]=e[o]);return n}var xe=S.forwardRef(function(e,r){var n=e.color,t=n===void 0?"currentColor":n,o=e.size,a=o===void 0?24:o,c=Zt(e,["color","size"]);return k.createElement("svg",pe({ref:r,xmlns:"http://www.w3.org/2000/svg",width:a,height:a,viewBox:"0 0 24 24",fill:"none",stroke:t,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},c),k.createElement("path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"}),k.createElement("path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"}))});xe.propTypes={color:x.string,size:x.oneOfType([x.string,x.number])};xe.displayName="Link";const Qt=xe;function he(){return he=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])}return e},he.apply(this,arguments)}function Xt(e,r){if(e==null)return{};var n=er(e,r),t,o;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)t=a[o],!(r.indexOf(t)>=0)&&Object.prototype.propertyIsEnumerable.call(e,t)&&(n[t]=e[t])}return n}function er(e,r){if(e==null)return{};var n={},t=Object.keys(e),o,a;for(a=0;a<t.length;a++)o=t[a],!(r.indexOf(o)>=0)&&(n[o]=e[o]);return n}var Ce=S.forwardRef(function(e,r){var n=e.color,t=n===void 0?"currentColor":n,o=e.size,a=o===void 0?24:o,c=Xt(e,["color","size"]);return k.createElement("svg",he({ref:r,xmlns:"http://www.w3.org/2000/svg",width:a,height:a,viewBox:"0 0 24 24",fill:"none",stroke:t,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},c),k.createElement("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),k.createElement("line",{x1:"5",y1:"12",x2:"19",y2:"12"}))});Ce.propTypes={color:x.string,size:x.oneOfType([x.string,x.number])};Ce.displayName="Plus";const He=Ce;function fe(){return fe=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])}return e},fe.apply(this,arguments)}function tr(e,r){if(e==null)return{};var n=rr(e,r),t,o;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)t=a[o],!(r.indexOf(t)>=0)&&Object.prototype.propertyIsEnumerable.call(e,t)&&(n[t]=e[t])}return n}function rr(e,r){if(e==null)return{};var n={},t=Object.keys(e),o,a;for(a=0;a<t.length;a++)o=t[a],!(r.indexOf(o)>=0)&&(n[o]=e[o]);return n}var ke=S.forwardRef(function(e,r){var n=e.color,t=n===void 0?"currentColor":n,o=e.size,a=o===void 0?24:o,c=tr(e,["color","size"]);return k.createElement("svg",fe({ref:r,xmlns:"http://www.w3.org/2000/svg",width:a,height:a,viewBox:"0 0 24 24",fill:"none",stroke:t,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},c),k.createElement("polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2"}))});ke.propTypes={color:x.string,size:x.oneOfType([x.string,x.number])};ke.displayName="Zap";const K=ke,nr="_FlexCenter_1380a_1",or={FlexCenter:nr};function sr({children:e}){return s("div",{className:or.FlexCenter,children:e})}const{useRef:Te,useEffect:ar}=R;function ir({onClickPrimaryButton:e,onClickSecondaryButton:r}){const n=Te(null),t=Te(null);return ar(()=>{n.current.focus()},[]),u("div",{onKeyDown:a=>{a.keyCode===39?t.current.focus():a.keyCode===37&&n.current.focus()},children:[s("h2",{children:"Close Connections?"}),s("p",{children:"Click 'Yes' to close those connections that are still using the old selected proxy in this group"}),s("div",{style:{height:30}}),u(sr,{children:[s(T,{onClick:e,ref:n,children:"Yes"}),s("div",{style:{width:20}}),s(T,{onClick:r,ref:t,children:"No"})]})]})}const cr="_header_19ilz_1",lr="_arrow_19ilz_9",ur="_isOpen_19ilz_14",dr="_btn_19ilz_21",pr="_qty_19ilz_26",Ee={header:cr,arrow:lr,isOpen:ur,btn:dr,qty:pr};function Ke({name:e,type:r,toggle:n,qty:t}){const o=S.useCallback(a=>{a.preventDefault(),(a.key==="Enter"||a.key===" ")&&n()},[n]);return u("div",{className:Ee.header,onClick:n,style:{cursor:"pointer"},tabIndex:0,onKeyDown:o,role:"button",children:[s("div",{children:s(ft,{name:e,type:r})}),typeof t=="number"?s("span",{className:Ee.qty,children:t}):null]})}const{useMemo:hr}=R;function fr(e,r){return e.filter(n=>{const t=r[n];return t===void 0?!0:t.number!==0})}const Y=(e,r)=>{if(e&&typeof e.number=="number"&&e.number>0)return e.number;const n=r&&r.type;return n&&vt.indexOf(n)>-1?-1:999999},mr={Natural:e=>e,LatencyAsc:(e,r,n)=>e.sort((t,o)=>{const a=Y(r[t],n&&n[t]),c=Y(r[o],n&&n[o]);return a-c}),LatencyDesc:(e,r,n)=>e.sort((t,o)=>{const a=Y(r[t],n&&n[t]);return Y(r[o],n&&n[o])-a}),NameAsc:e=>e.sort(),NameDesc:e=>e.sort((r,n)=>r>n?-1:r<n?1:0)};function vr(e,r){const n=r.toLowerCase().split(" ").map(t=>t.trim()).filter(t=>!!t);return n.length===0?e:e.filter(t=>{let o=0;for(;o<n.length;o++){const a=n[o];if(t.toLowerCase().indexOf(a)>-1)return!0}return!1})}function yr(e,r,n,t,o,a){let c=[...e];return n&&(c=fr(e,r)),typeof t=="string"&&t!==""&&(c=vr(c,t)),mr[o](c,r,a)}function Ve(e,r,n,t,o){const[a]=mt(Be);return hr(()=>yr(e,r,n,a,t,o),[e,r,n,a,t,o])}const gr="_header_1qjca_1",_r="_group_1qjca_5",br="_zapWrapper_1qjca_12",wr="_arrow_1qjca_20",xr="_isOpen_1qjca_25",$={header:gr,group:_r,zapWrapper:br,arrow:wr,isOpen:xr},Ye={Right:39,Left:37,Enter:13,Space:32},Cr="_proxy_xgbmr_4",kr="_now_xgbmr_25",Nr="_error_xgbmr_29",Or="_selectable_xgbmr_32",Pr="_proxyType_xgbmr_40",Tr="_udpType_xgbmr_50",Er="_tfoType_xgbmr_61",$r="_row_xgbmr_65",Sr="_proxyName_xgbmr_73",Rr="_proxySmall_xgbmr_84",P={proxy:Cr,now:kr,error:Nr,selectable:Or,proxyType:Pr,udpType:Tr,tfoType:Er,row:$r,proxyName:Sr,proxySmall:Rr},Lr="_proxyLatency_1h5y2_4",Mr={proxyLatency:Lr};function zr({number:e,color:r}){return s("span",{className:Mr.proxyLatency,style:{color:r},children:u("span",{children:[e," ms"]})})}const{useMemo:X}=R,H={good:"#67c23a",normal:"#d4b75c",bad:"#e67f3c",na:"#909399"};function Ze({number:e}={},r){const n={good:r?800:200,normal:r?1500:500};return e===0?H.na:e<n.good?H.good:e<n.normal?H.normal:typeof e=="number"?H.bad:H.na}function Ar(e,r){return Ze(e,r)}function jr({now:e,name:r,proxy:n,latency:t,httpsLatencyTest:o,isSelectable:a,onClick:c}){var y;const p=(y=n.history[n.history.length-1])==null?void 0:y.delay,h=(t==null?void 0:t.number)??p,m=X(()=>Ar({number:h},o),[h]),i=X(()=>{let v=r;return t&&typeof t.number=="number"&&(v+=" "+t.number+" ms"),v},[r,t]),f=S.useCallback(()=>{a&&c&&c(r)},[r,c,a]),_=S.useCallback(v=>{v.keyCode===Ye.Enter&&f()},[f]);return s("div",{title:i,className:j(P.proxySmall,{[P.selectable]:a}),style:{background:m,scale:e?"1.2":"1"},onClick:f,onKeyDown:_,role:a?"menuitem":"",children:e&&s("div",{className:P.now})})}function Dr(e){return e==="Shadowsocks"?"SS":e}const Br=e=>({left:e.left+window.scrollX-5,top:e.top+window.scrollY-38});function Fr({children:e,label:r,"aria-label":n}){const[t,o]=yt();return u(M,{children:[S.cloneElement(e,t),s(gt,{...o,label:r,"aria-label":n,position:Br})]})}function Gr({now:e,name:r,proxy:n,latency:t,httpsLatencyTest:o,isSelectable:a,onClick:c}){var N;const p=(N=n.history[n.history.length-1])==null?void 0:N.delay,h=(t==null?void 0:t.number)??p,m=X(()=>Ze({number:h},o),[h]),i=S.useCallback(()=>{a&&c&&c(r)},[r,c,a]);function f(g,w){return g?w?"XUDP":"UDP":""}function _(g){return g?s("svg",{viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"2962",width:"10",height:"10",children:s("path",{d:"M648.093513 719.209284l-1.492609-40.940127 31.046263-26.739021c202.73892-174.805813 284.022131-385.860697 255.70521-561.306199-176.938111-28.786027-389.698834 51.857494-563.907604 254.511123l-26.31256 30.619803-40.38573-0.938211c-60.557271-1.407317-111.903014 12.79379-162.822297 47.0385l189.561318 127.084977-37.95491 68.489421c-9.126237 16.461343-0.554398 53.307457 29.084549 82.818465 29.5963 29.511008 67.380626 38.381369 83.287571 29.852176l68.318836-36.760822 127.639376 191.267156c36.163779-52.11337 50.450177-103.629696 48.189941-165.039887zM994.336107 16.105249l10.490908 2.686696 2.64405 10.405615c47.46496 178.089552-1.023503 451.492838-274.170913 686.898568 4.051367 111.263324-35.396151 200.222809-127.255561 291.741051l-15.779008 15.693715-145.934494-218.731157c-51.217805 27.59194-128.790816 10.405616-183.93205-44.522388-55.226525-55.013296-72.41285-132.287785-43.498885-184.529093L0.002773 430.325513l15.736362-15.65107c89.300652-88.959484 178.64395-128.108481 289.011709-125.549722C539.730114 15.806727 815.56422-31.061189 994.336107 16.105249zM214.93844 805.098259c28.572797 28.572797 22.346486 79.49208-12.537914 114.376479C156.428175 965.489735 34.034254 986.002445 34.034254 986.002445s25.331704-127.084978 66.612998-168.323627c34.8844-34.8844 85.633099-41.281295 114.291188-12.580559zM661.01524 298.549479a63.968948 63.968948 0 1 0 0 127.937897 63.968948 63.968948 0 0 0 0-127.937897z","p-id":"2963"})}):""}const y=S.useCallback(g=>{g.keyCode===Ye.Enter&&i()},[i]),v=X(()=>j(P.proxy,{[P.now]:e,[P.error]:t&&t.error,[P.selectable]:a}),[a,e,t]);return u("div",{tabIndex:0,className:v,onClick:i,onKeyDown:y,role:a?"menuitem":"",children:[u("div",{className:j(P.proxyName,P.row),children:[s(Fr,{label:r,"aria-label":`proxy name: ${r}`,children:s("span",{children:r})}),s("span",{className:P.proxyType,style:{paddingLeft:4,opacity:.6,color:"#51A8DD"},children:f(n.udp,n.xudp)})]}),u("div",{className:P.row,children:[u("div",{className:P.row,children:[s("span",{className:P.proxyType,style:{paddingRight:4,opacity:.6,color:"#F596AA"},children:Dr(n.type)}),_(n.tfo)]}),h?s(zr,{number:h,color:m}):null]})]})}const Je=(e,{name:r})=>{const n=Fe(e),t=ve(e),o=Ge(e);return{proxy:n[r]||{name:r,history:[]},latency:t[r],httpsLatencyTest:o.startsWith("https://")}},Ir=B(Je)(Gr),Wr=B(Je)(jr),Ur="_list_4awfc_4",qr="_detail_4awfc_10",Hr="_summary_4awfc_19",ee={list:Ur,detail:qr,summary:Hr};function Qe({all:e,now:r,isSelectable:n,itemOnTapCallback:t}){const o=e;return s("div",{className:j(ee.list,ee.detail),children:o.map(a=>s(Ir,{onClick:t,isSelectable:n,name:a,now:a===r},a))})}function Xe({all:e,now:r,isSelectable:n,itemOnTapCallback:t}){return s("div",{className:j(ee.list,ee.summary),children:e.map(o=>s(Wr,{onClick:t,isSelectable:n,name:o,now:o===r},o))})}const{createElement:Kr,useCallback:ie,useMemo:Vr,useState:$e,useEffect:Yr}=R;function Se(){return s("div",{className:$.zapWrapper,children:s(K,{size:16})})}function Zr({name:e,all:r,delay:n,hideUnavailableProxies:t,proxySortBy:o,proxies:a,type:c,now:p,isOpen:h,latencyTestUrl:m,apiConfig:i,dispatch:f}){const _=Ve(r,n,t,o,a),{data:y}=_t(["/version",i],()=>xt("/version",i)),v=Vr(()=>["Selector",y.meta&&"Fallback",y.meta&&"URLTest"].includes(c),[c,y.meta]),{app:{updateCollapsibleIsOpen:N},proxies:{requestDelayForProxies:g}}=V(),w=ie(()=>{N("proxyGroup",e,!h)},[h,N,e]),z=ie(W=>{v&&f(bt(i,e,W))},[i,f,e,v]),[F,C]=$e(!1),G=ie(async()=>{C(!0);try{y.meta===!0?(await wt(i,e,m),await f(Q(i))):(await g(i,_),await f(Q(i)))}catch{}C(!1)},[_,i,f,e,y.meta]),[I,E]=$e(window.innerWidth),b=()=>{E(window.innerWidth)};return Yr(()=>(window.addEventListener("resize",b),()=>window.removeEventListener("resize",b)),[]),u("div",{className:$.group,children:[u("div",{style:{display:"flex",alignItems:"center",justifyContent:I>768?"start":"space-between"},children:[s(Ke,{name:e,type:c,toggle:w,qty:_.length}),s("div",{style:{display:"flex"},children:I>768?u(M,{children:[s(T,{kind:"minimal",onClick:w,className:$.btn,title:"Toggle collapsible section",children:s("span",{className:j($.arrow,{[$.isOpen]:h}),children:s(ue,{size:20})})}),s(T,{title:"Test latency",kind:"minimal",onClick:G,isLoading:F,children:s(Se,{})})]}):u(M,{children:[s(T,{title:"Test latency",kind:"minimal",onClick:G,isLoading:F,children:s(Se,{})}),s(T,{kind:"minimal",onClick:w,className:$.btn,title:"Toggle collapsible section",children:s("span",{className:j($.arrow,{[$.isOpen]:h}),children:s(ue,{size:20})})})]})})]}),Kr(h?Qe:Xe,{all:_,now:p,isSelectable:v,itemOnTapCallback:z})]})}const Jr=B((e,{name:r,delay:n})=>{const t=Fe(e),o=Ie(e),a=ye(e),c=ge(e),p=Ge(e),h=t[r],{all:m,type:i,now:f}=h;return{all:m,delay:n,hideUnavailableProxies:c,proxySortBy:a,proxies:t,type:i,now:f,isOpen:o[`proxyGroup:${r}`],latencyTestUrl:p}})(Zr),{useCallback:et,useState:Qr}=R;function Xr({dispatch:e,apiConfig:r,name:n}){return et(()=>e(Ct(r,n)),[r,e,n])}function en({dispatch:e,apiConfig:r,names:n}){const[t,o]=Qr(!1);return[et(async()=>{if(!t){o(!0);try{await e(kt(r,n))}catch{}o(!1)}},[r,e,n,t]),t]}const{useState:tn,useCallback:rn}=R;function nn({isLoading:e}){return e?s(Gt,{children:s(K,{width:16,height:16})}):s(K,{width:16,height:16})}function on({dispatch:e,apiConfig:r}){const[n,t]=tn(!1);return[rn(()=>{n||(t(!0),e(Nt(r)).then(()=>t(!1),()=>t(!1)))},[r,e,n]),n]}function sn({dispatch:e,apiConfig:r,proxyProviders:n}){const{t}=ne(),[o,a]=on({dispatch:e,apiConfig:r}),[c,p]=en({apiConfig:r,dispatch:e,names:n.map(h=>h.name)});return s(Dt,{icon:s(nn,{isLoading:a}),onClick:o,text:t("Test Latency"),style:Bt,children:n.length>0?s(Ft,{text:t("update_all_proxy_provider"),onClick:c,children:s(It,{isRotating:p})}):null})}var tt=function(){if(typeof Map<"u")return Map;function e(r,n){var t=-1;return r.some(function(o,a){return o[0]===n?(t=a,!0):!1}),t}return function(){function r(){this.__entries__=[]}return Object.defineProperty(r.prototype,"size",{get:function(){return this.__entries__.length},enumerable:!0,configurable:!0}),r.prototype.get=function(n){var t=e(this.__entries__,n),o=this.__entries__[t];return o&&o[1]},r.prototype.set=function(n,t){var o=e(this.__entries__,n);~o?this.__entries__[o][1]=t:this.__entries__.push([n,t])},r.prototype.delete=function(n){var t=this.__entries__,o=e(t,n);~o&&t.splice(o,1)},r.prototype.has=function(n){return!!~e(this.__entries__,n)},r.prototype.clear=function(){this.__entries__.splice(0)},r.prototype.forEach=function(n,t){t===void 0&&(t=null);for(var o=0,a=this.__entries__;o<a.length;o++){var c=a[o];n.call(t,c[1],c[0])}},r}()}(),me=typeof window<"u"&&typeof document<"u"&&window.document===document,te=function(){return typeof global<"u"&&global.Math===Math?global:typeof self<"u"&&self.Math===Math?self:typeof window<"u"&&window.Math===Math?window:Function("return this")()}(),an=function(){return typeof requestAnimationFrame=="function"?requestAnimationFrame.bind(te):function(e){return setTimeout(function(){return e(Date.now())},1e3/60)}}(),cn=2;function ln(e,r){var n=!1,t=!1,o=0;function a(){n&&(n=!1,e()),t&&p()}function c(){an(a)}function p(){var h=Date.now();if(n){if(h-o<cn)return;t=!0}else n=!0,t=!1,setTimeout(c,r);o=h}return p}var un=20,dn=["top","right","bottom","left","width","height","size","weight"],pn=typeof MutationObserver<"u",hn=function(){function e(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=ln(this.refresh.bind(this),un)}return e.prototype.addObserver=function(r){~this.observers_.indexOf(r)||this.observers_.push(r),this.connected_||this.connect_()},e.prototype.removeObserver=function(r){var n=this.observers_,t=n.indexOf(r);~t&&n.splice(t,1),!n.length&&this.connected_&&this.disconnect_()},e.prototype.refresh=function(){var r=this.updateObservers_();r&&this.refresh()},e.prototype.updateObservers_=function(){var r=this.observers_.filter(function(n){return n.gatherActive(),n.hasActive()});return r.forEach(function(n){return n.broadcastActive()}),r.length>0},e.prototype.connect_=function(){!me||this.connected_||(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),pn?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},e.prototype.disconnect_=function(){!me||!this.connected_||(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},e.prototype.onTransitionEnd_=function(r){var n=r.propertyName,t=n===void 0?"":n,o=dn.some(function(a){return!!~t.indexOf(a)});o&&this.refresh()},e.getInstance=function(){return this.instance_||(this.instance_=new e),this.instance_},e.instance_=null,e}(),rt=function(e,r){for(var n=0,t=Object.keys(r);n<t.length;n++){var o=t[n];Object.defineProperty(e,o,{value:r[o],enumerable:!1,writable:!1,configurable:!0})}return e},q=function(e){var r=e&&e.ownerDocument&&e.ownerDocument.defaultView;return r||te},nt=oe(0,0,0,0);function re(e){return parseFloat(e)||0}function Re(e){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];return r.reduce(function(t,o){var a=e["border-"+o+"-width"];return t+re(a)},0)}function fn(e){for(var r=["top","right","bottom","left"],n={},t=0,o=r;t<o.length;t++){var a=o[t],c=e["padding-"+a];n[a]=re(c)}return n}function mn(e){var r=e.getBBox();return oe(0,0,r.width,r.height)}function vn(e){var r=e.clientWidth,n=e.clientHeight;if(!r&&!n)return nt;var t=q(e).getComputedStyle(e),o=fn(t),a=o.left+o.right,c=o.top+o.bottom,p=re(t.width),h=re(t.height);if(t.boxSizing==="border-box"&&(Math.round(p+a)!==r&&(p-=Re(t,"left","right")+a),Math.round(h+c)!==n&&(h-=Re(t,"top","bottom")+c)),!gn(e)){var m=Math.round(p+a)-r,i=Math.round(h+c)-n;Math.abs(m)!==1&&(p-=m),Math.abs(i)!==1&&(h-=i)}return oe(o.left,o.top,p,h)}var yn=function(){return typeof SVGGraphicsElement<"u"?function(e){return e instanceof q(e).SVGGraphicsElement}:function(e){return e instanceof q(e).SVGElement&&typeof e.getBBox=="function"}}();function gn(e){return e===q(e).document.documentElement}function _n(e){return me?yn(e)?mn(e):vn(e):nt}function bn(e){var r=e.x,n=e.y,t=e.width,o=e.height,a=typeof DOMRectReadOnly<"u"?DOMRectReadOnly:Object,c=Object.create(a.prototype);return rt(c,{x:r,y:n,width:t,height:o,top:n,right:r+t,bottom:o+n,left:r}),c}function oe(e,r,n,t){return{x:e,y:r,width:n,height:t}}var wn=function(){function e(r){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=oe(0,0,0,0),this.target=r}return e.prototype.isActive=function(){var r=_n(this.target);return this.contentRect_=r,r.width!==this.broadcastWidth||r.height!==this.broadcastHeight},e.prototype.broadcastRect=function(){var r=this.contentRect_;return this.broadcastWidth=r.width,this.broadcastHeight=r.height,r},e}(),xn=function(){function e(r,n){var t=bn(n);rt(this,{target:r,contentRect:t})}return e}(),Cn=function(){function e(r,n,t){if(this.activeObservations_=[],this.observations_=new tt,typeof r!="function")throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=r,this.controller_=n,this.callbackCtx_=t}return e.prototype.observe=function(r){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if(!(typeof Element>"u"||!(Element instanceof Object))){if(!(r instanceof q(r).Element))throw new TypeError('parameter 1 is not of type "Element".');var n=this.observations_;n.has(r)||(n.set(r,new wn(r)),this.controller_.addObserver(this),this.controller_.refresh())}},e.prototype.unobserve=function(r){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if(!(typeof Element>"u"||!(Element instanceof Object))){if(!(r instanceof q(r).Element))throw new TypeError('parameter 1 is not of type "Element".');var n=this.observations_;n.has(r)&&(n.delete(r),n.size||this.controller_.removeObserver(this))}},e.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},e.prototype.gatherActive=function(){var r=this;this.clearActive(),this.observations_.forEach(function(n){n.isActive()&&r.activeObservations_.push(n)})},e.prototype.broadcastActive=function(){if(this.hasActive()){var r=this.callbackCtx_,n=this.activeObservations_.map(function(t){return new xn(t.target,t.broadcastRect())});this.callback_.call(r,n,r),this.clearActive()}},e.prototype.clearActive=function(){this.activeObservations_.splice(0)},e.prototype.hasActive=function(){return this.activeObservations_.length>0},e}(),ot=typeof WeakMap<"u"?new WeakMap:new tt,st=function(){function e(r){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var n=hn.getInstance(),t=new Cn(r,n,this);ot.set(this,t)}return e}();["observe","unobserve","disconnect"].forEach(function(e){st.prototype[e]=function(){var r;return(r=ot.get(this))[e].apply(r,arguments)}});var kn=function(){return typeof te.ResizeObserver<"u"?te.ResizeObserver:st}();const{memo:Nn,useState:On,useRef:at,useEffect:it}=k;function Pn(e){const r=at();return it(()=>void(r.current=e),[e]),r.current}function Tn(){const e=at(),[r,n]=On({height:0});return it(()=>{const t=new kn(([o])=>n(o.contentRect));return e.current&&t.observe(e.current),()=>t.disconnect()},[]),[e,r]}const En={initialOpen:{height:"auto",transition:{duration:0}},open:e=>({height:e,opacity:1,visibility:"visible",transition:{duration:.3}}),closed:{height:0,opacity:0,visibility:"hidden",overflowY:"hidden",transition:{duration:.3}}},$n={open:{},closed:{}},Le=Nn(({children:e,isOpen:r})=>{const t=We.read().motion,o=Pn(r),[a,{height:c}]=Tn();return s("div",{children:s(t.div,{animate:r&&o===r?"initialOpen":r?"open":"closed",custom:c,variants:En,children:s(t.div,{variants:$n,ref:a,children:e})})})}),Sn="_updatedAt_1d817_4",Rn="_body_1d817_12",Ln="_actionFooter_1d817_25",Mn="_refresh_1d817_35",J={updatedAt:Sn,body:Rn,actionFooter:Ln,refresh:Mn},{useState:zn,useCallback:Me}=R;function An({name:e,proxies:r,delay:n,hideUnavailableProxies:t,proxySortBy:o,vehicleType:a,updatedAt:c,subscriptionInfo:p,isOpen:h,dispatch:m,apiConfig:i}){const f=Ve(r,n,t,o),[_,y]=zn(!1),v=Xr({dispatch:m,apiConfig:i,name:e}),N=Me(async()=>{y(!0),await m(Ot(i,e)),y(!1)},[i,m,e,y]),{app:{updateCollapsibleIsOpen:g}}=V(),w=Me(()=>{g("proxyProvider",e,!h)},[h,g,e]),z=Ut(new Date(c),new Date),F=p?ze(p.Total):0,C=p?ze(p.Download+p.Upload):0,G=p?((p.Download+p.Upload)/p.Total*100).toFixed(2):0,I=()=>{if(p.Expire===0)return"Null";const E=new Date(p.Expire*1e3),b=E.getFullYear()+"-",W=(E.getMonth()+1<10?"0"+(E.getMonth()+1):E.getMonth()+1)+"-",se=(E.getDate()<10?"0"+E.getDate():E.getDate())+" ";return b+W+se};return u("div",{className:J.body,children:[u("div",{style:{display:"flex",alignItems:"center",flexWrap:"wrap",justifyContent:"space-between"},children:[s(Ke,{name:e,toggle:w,type:a,isOpen:h,qty:f.length}),u("div",{style:{display:"flex"},children:[s(T,{kind:"minimal",onClick:w,className:$.btn,title:"Toggle collapsible section",children:s("span",{className:j($.arrow,{[$.isOpen]:h}),children:s(ue,{size:20})})}),s(T,{kind:"minimal",start:s(Ae,{}),onClick:v}),s(T,{kind:"minimal",start:s(K,{size:16}),onClick:N,isLoading:_})]})]}),u("div",{className:J.updatedAt,children:[p&&u("small",{children:[C," / ",F," ( ",G,"% )    Expire: ",I()," "]}),s("br",{}),u("small",{children:["Updated ",z," ago"]})]}),u(Le,{isOpen:h,children:[s(Qe,{all:f}),u("div",{className:J.actionFooter,children:[s(T,{text:"Update",start:s(Ae,{}),onClick:v}),s(T,{text:"Health Check",start:s(K,{size:16}),onClick:N,isLoading:_})]})]}),s(Le,{isOpen:!h,children:s(Xe,{all:f})})]})}const jn={rest:{scale:1},pressed:{scale:.95}},Dn={rest:{rotate:0},hover:{rotate:360,transition:{duration:.3}}};function ze(e,r=2){if(!+e)return"0 Bytes";const n=1024,t=r<0?0:r,o=["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"],a=Math.floor(Math.log(e)/Math.log(n));return`${parseFloat((e/Math.pow(n,a)).toFixed(t))} ${o[a]}`}function Ae(){const r=We.read().motion;return s(r.div,{className:J.refresh,variants:jn,initial:"rest",whileHover:"hover",whileTap:"pressed",children:s(r.div,{className:"flexCenter",variants:Dn,children:s(qt,{size:16})})})}const Bn=(e,{proxies:r,name:n})=>{const t=ge(e),o=ve(e),a=Ie(e),c=_e(e),p=ye(e);return{apiConfig:c,proxies:r,delay:o,hideUnavailableProxies:t,proxySortBy:p,isOpen:a[`proxyProvider:${n}`]}},Fn=B(Bn)(An);function Gn({items:e}){return e.length===0?null:u(M,{children:[s(Ue,{title:"Proxy Provider"}),s("div",{children:e.map(r=>s(Fn,{name:r.name,proxies:r.proxies,type:r.type,vehicleType:r.vehicleType,updatedAt:r.updatedAt,subscriptionInfo:r.subscriptionInfo},r.name))})]})}const In="_labeledInput_cmki0_1",ce={labeledInput:In},Wn=[["Natural","order_natural"],["LatencyAsc","order_latency_asc"],["LatencyDesc","order_latency_desc"],["NameAsc","order_name_asc"],["NameDesc","order_name_desc"]],{useCallback:je}=R;function Un({appConfig:e}){const{app:{updateAppConfig:r}}=V(),n=je(a=>{r("proxySortBy",a.target.value)},[r]),t=je(a=>{r("hideUnavailableProxies",a)},[r]),{t:o}=ne();return u(M,{children:[u("div",{className:ce.labeledInput,children:[s("span",{children:o("sort_in_grp")}),s("div",{children:s(Ht,{options:Wn.map(a=>[a[0],o(a[1])]),selected:e.proxySortBy,onChange:n})})]}),s("hr",{}),u("div",{className:ce.labeledInput,children:[s("span",{children:o("hide_unavail_proxies")}),s("div",{children:s(Oe,{name:"hideUnavailableProxies",checked:e.hideUnavailableProxies,onChange:t})})]}),u("div",{className:ce.labeledInput,children:[s("span",{children:o("auto_close_conns")}),s("div",{children:s(Oe,{name:"autoCloseOldConns",checked:e.autoCloseOldConns,onChange:a=>r("autoCloseOldConns",a)})})]})]})}const qn=e=>{const r=ye(e),n=ge(e),t=Pt(e);return{appConfig:{proxySortBy:r,hideUnavailableProxies:n,autoCloseOldConns:t}}},Hn=B(qn)(Un);async function Kn(e){try{const{url:r,init:n}=be(e);return await(await fetch(r+"/configs",n)).json()}catch(r){throw console.error("获取配置失败:",r),r}}async function Vn(e,r){try{const{url:n,init:t}=be(e),o=await fetch(n+"/configs",{...t,method:"PUT",body:JSON.stringify(r)});return!0}catch(n){return console.error("配置验证失败:",n),!1}}function Yn(e,r){e.proxies||(e.proxies=[]);const n=new Set(e.proxies.map(o=>o.name)),t=[];for(const o of r)n.has(o.name)||(e.proxies.push(o),n.add(o.name),t.push(o.name));return{config:e,addedNodes:t}}function Zn(e,r){var o,a;e["proxy-groups"]||(e["proxy-groups"]=[]);const n=e["proxy-groups"],t=[];for(const c of n)if(c.type==="select"||c.type==="url-test"||c.type==="fallback"||c.type==="load-balance"){const p=((o=c.proxies)==null?void 0:o.filter(i=>i==="REJECT"||i==="DIRECT"))||[],h=((a=c.proxies)==null?void 0:a.filter(i=>i!=="REJECT"&&i!=="DIRECT"))||[],m=r.filter(i=>!h.includes(i));c.proxies=[...p,...h,...m],t.push(c.name)}return{config:e,updatedGroups:t}}async function Jn(e,r){try{if(!await Vn(e,r))throw new Error("配置验证失败");const{url:t,init:o}=be(e),a=await fetch(t+"/configs",{...o,method:"PUT",body:JSON.stringify(r)});return await Qn(),{success:!0}}catch(n){throw console.error("写入配置失败:",n),n}}async function Qn(){try{return console.log("重启命令:","/etc/init.d/openclash restart"),await new Promise(r=>setTimeout(r,5e3)),!0}catch(e){throw console.error("重启 OpenClash 失败:",e),e}}async function Xn(e,r){try{console.log("开始自动同步节点...");const n=await Kn(e),{config:t,addedNodes:o}=Yn(n,r),{config:a,updatedGroups:c}=Zn(t,o),p=await Jn(e,a);return console.log("✅ 自动同步完成！"),console.log(`- 添加节点: ${o.length} 个`),console.log(`- 更新策略组: ${c.length} 个`),{success:!0,addedNodes:o,updatedGroups:c}}catch(n){throw console.error("自动同步失败:",n),n}}const eo="_container_p8tt0_1",to="_tabs_p8tt0_7",ro="_tab_p8tt0_7",no="_active_p8tt0_24",oo="_form_p8tt0_29",so="_formRow_p8tt0_35",ao="_formGroup_p8tt0_41",io="_label_p8tt0_48",co="_input_p8tt0_54",lo="_select_p8tt0_67",uo="_textarea_p8tt0_80",po="_button_p8tt0_95",ho="_primary_p8tt0_104",fo="_secondary_p8tt0_115",mo="_buttonGroup_p8tt0_124",vo="_checkbox_p8tt0_131",yo="_groupSelector_p8tt0_146",go="_groupItem_p8tt0_157",_o="_message_p8tt0_172",bo="_success_p8tt0_178",wo="_error_p8tt0_183",xo="_info_p8tt0_188",Co="_loading_p8tt0_194",ko="_spinner_p8tt0_202",No="_spin_p8tt0_202",l={container:eo,tabs:to,tab:ro,active:no,form:oo,formRow:so,formGroup:ao,label:io,input:co,select:lo,textarea:uo,button:po,primary:ho,secondary:fo,buttonGroup:mo,checkbox:vo,groupSelector:yo,groupItem:go,message:_o,success:bo,error:wo,info:xo,loading:Co,spinner:ko,spin:No},{useState:A,useCallback:L}=R;function Oo({dispatch:e,groupNames:r,apiConfig:n}){const{t}=ne(),[o,a]=A("manual"),[c,p]=A(!1),[h,m]=A(null),[i,f]=A({name:"",type:"vmess",server:"",port:"",password:"",method:"auto",uuid:"",security:"auto",network:"tcp",sni:"",path:"",host:"",protocol:"origin",obfs:"plain",username:""}),[_,y]=A(""),[v,N]=A(""),[g,w]=A([]),[z,F]=A(!1);V();const C=L((d,O)=>{f(D=>({...D,[d]:O}))},[]),G=L(d=>{w(O=>O.includes(d)?O.filter(D=>D!==d):[...O,d])},[]),I=L(()=>{F(d=>!d),w([])},[]),E=L(()=>{m(null)},[]),b=L((d,O)=>{m({type:d,text:O}),setTimeout(E,5e3)},[E]),W=L(async()=>{if(!i.name||!i.server||!i.port){b("error",t("请填写必要的节点信息"));return}p(!0);try{const d=await Tt(n);console.log("获取到的策略组:",d);const O=z?d:g;if(O.length===0){b("error",t("请选择至少一个策略组"));return}const D={name:i.name,type:i.type,server:i.server,port:parseInt(i.port),...i.password&&{password:i.password},...i.method&&{method:i.method},...i.uuid&&{uuid:i.uuid},...i.security&&{security:i.security},...i.network&&{network:i.network},...i.sni&&{sni:i.sni},...i.path&&{path:i.path},...i.host&&{host:i.host},...i.protocol&&{protocol:i.protocol},...i.obfs&&{obfs:i.obfs},...i.username&&{username:i.username}};console.log("添加节点配置:",D),console.log("目标策略组:",O),await Et(n,D);const ht=await Promise.all(O.map(async U=>{try{return await $t(n,U,i.name)}catch(Ne){return console.error(`添加到策略组 ${U} 失败:`,Ne),{error:Ne.message}}}));console.log("添加结果:",ht);try{const U=await Xn(n,[D]);console.log("自动同步结果:",U),b("success",t("add_proxy_success")+" (自动同步已启用)")}catch(U){console.error("自动同步失败:",U),b("success",t("add_proxy_success")+" (自动同步失败)")}await e(Q(n)),f({name:"",type:"vmess",server:"",port:"",password:"",method:"auto",uuid:"",security:"auto",network:"tcp",sni:"",path:"",host:"",protocol:"origin",obfs:"plain",username:""})}catch(d){console.error("添加节点失败:",d),b("error",t("add_proxy_failed"))}finally{p(!1)}},[i,z,g,r,n,e,t]),se=L(async()=>{if(!_){b("error",t("请输入订阅链接"));return}p(!0);try{const d=await St(_);b("success",`${t("parse_proxy_success")}，共解析出 ${d.length} 个节点`),console.log("解析的节点:",d),y("")}catch{b("error",t("parse_proxy_failed"))}finally{p(!1)}},[_,t]),ct=L(async()=>{if(!v){b("error",t("请输入节点配置文本"));return}p(!0);try{const d=Rt(v);b("success",`${t("parse_proxy_success")}，共解析出 ${d.length} 个节点`),console.log("解析的节点:",d),N("")}catch{b("error",t("parse_proxy_failed"))}finally{p(!1)}},[v,t]),lt=L(async()=>{p(!0);try{const d=await Lt(n),O=Mt(d);zt(O,"clash_config_export.yaml"),b("success","配置文件导出成功")}catch(d){console.error("导出配置失败:",d),b("error","导出配置失败")}finally{p(!1)}},[n,t]),ut=()=>u("div",{className:l.form,children:[u("div",{className:l.formRow,children:[u("div",{className:l.formGroup,children:[s("label",{className:l.label,children:t("proxy_name")}),s("input",{type:"text",className:l.input,value:i.name,onChange:d=>C("name",d.target.value),placeholder:"节点名称"})]}),u("div",{className:l.formGroup,children:[s("label",{className:l.label,children:t("proxy_type")}),u("select",{className:l.select,value:i.type,onChange:d=>C("type",d.target.value),children:[s("option",{value:"vmess",children:t("vmess")}),s("option",{value:"vless",children:t("vless")}),s("option",{value:"shadowsocks",children:t("shadowsocks")}),s("option",{value:"shadowsocksr",children:t("shadowsocksr")}),s("option",{value:"trojan",children:t("trojan")}),s("option",{value:"http",children:t("http")}),s("option",{value:"socks5",children:t("socks5")})]})]})]}),u("div",{className:l.formRow,children:[u("div",{className:l.formGroup,children:[s("label",{className:l.label,children:t("proxy_server")}),s("input",{type:"text",className:l.input,value:i.server,onChange:d=>C("server",d.target.value),placeholder:"服务器地址"})]}),u("div",{className:l.formGroup,children:[s("label",{className:l.label,children:t("proxy_port")}),s("input",{type:"text",className:l.input,value:i.port,onChange:d=>C("port",d.target.value),placeholder:"端口"})]})]}),i.type==="shadowsocks"&&u("div",{className:l.formRow,children:[u("div",{className:l.formGroup,children:[s("label",{className:l.label,children:t("proxy_password")}),s("input",{type:"password",className:l.input,value:i.password||"",onChange:d=>C("password",d.target.value),placeholder:"密码"})]}),u("div",{className:l.formGroup,children:[s("label",{className:l.label,children:t("proxy_method")}),u("select",{className:l.select,value:i.method||"auto",onChange:d=>C("method",d.target.value),children:[s("option",{value:"auto",children:t("auto")}),s("option",{value:"aes-128-gcm",children:t("aes-128-gcm")}),s("option",{value:"aes-256-gcm",children:t("aes-256-gcm")}),s("option",{value:"chacha20-poly1305",children:t("chacha20-poly1305")})]})]})]}),(i.type==="vmess"||i.type==="vless")&&u("div",{className:l.formRow,children:[u("div",{className:l.formGroup,children:[s("label",{className:l.label,children:t("proxy_uuid")}),s("input",{type:"text",className:l.input,value:i.uuid||"",onChange:d=>C("uuid",d.target.value),placeholder:"UUID"})]}),u("div",{className:l.formGroup,children:[s("label",{className:l.label,children:t("proxy_security")}),u("select",{className:l.select,value:i.security||"auto",onChange:d=>C("security",d.target.value),children:[s("option",{value:"auto",children:t("auto")}),s("option",{value:"none",children:t("none")}),s("option",{value:"tls",children:t("tls")}),s("option",{value:"xtls",children:t("xtls")})]})]})]}),u("div",{className:l.formRow,children:[u("div",{className:l.formGroup,children:[s("label",{className:l.label,children:t("proxy_network")}),u("select",{className:l.select,value:i.network||"tcp",onChange:d=>C("network",d.target.value),children:[s("option",{value:"tcp",children:t("tcp")}),s("option",{value:"ws",children:t("ws")}),s("option",{value:"h2",children:t("h2")}),s("option",{value:"grpc",children:t("grpc")})]})]}),u("div",{className:l.formGroup,children:[s("label",{className:l.label,children:t("proxy_sni")}),s("input",{type:"text",className:l.input,value:i.sni||"",onChange:d=>C("sni",d.target.value),placeholder:"SNI"})]})]}),u("div",{className:l.checkbox,children:[s("input",{type:"checkbox",checked:z,onChange:I}),s("span",{children:t("add_proxy_to_all_groups")})]}),!z&&u("div",{children:[s("label",{className:l.label,children:t("select_groups")}),s("div",{className:l.groupSelector,children:r.map(d=>u("div",{className:l.groupItem,children:[s("input",{type:"checkbox",checked:g.includes(d),onChange:()=>G(d)}),s("span",{children:d})]},d))})]}),s("div",{className:l.buttonGroup,children:s("button",{className:`${l.button} ${l.primary}`,onClick:W,disabled:c,children:c?u("div",{className:l.loading,children:[s("div",{className:l.spinner}),"添加中..."]}):u(M,{children:[s(He,{size:16}),t("add_proxy")]})})})]}),dt=()=>u("div",{className:l.form,children:[u("div",{className:l.formGroup,children:[s("label",{className:l.label,children:t("subscription_url")}),s("input",{type:"url",className:l.input,value:_,onChange:d=>y(d.target.value),placeholder:"https://example.com/subscription"})]}),s("div",{className:l.buttonGroup,children:s("button",{className:`${l.button} ${l.primary}`,onClick:se,disabled:c,children:c?u("div",{className:l.loading,children:[s("div",{className:l.spinner}),"解析中..."]}):u(M,{children:[s(Qt,{size:16}),t("parse_proxy")]})})})]}),pt=()=>u("div",{className:l.form,children:[u("div",{className:l.formGroup,children:[s("label",{className:l.label,children:t("proxy_text")}),s("textarea",{className:l.textarea,value:v,onChange:d=>N(d.target.value),placeholder:`vmess://...
vless://...
ss://...`})]}),s("div",{className:l.buttonGroup,children:s("button",{className:`${l.button} ${l.primary}`,onClick:ct,disabled:c,children:c?u("div",{className:l.loading,children:[s("div",{className:l.spinner}),"解析中..."]}):u(M,{children:[s(Yt,{size:16}),t("parse_proxy")]})})})]});return u("div",{className:l.container,children:[u("div",{className:l.tabs,children:[s("button",{className:`${l.tab} ${o==="manual"?l.active:""}`,onClick:()=>a("manual"),children:t("add_proxy")}),s("button",{className:`${l.tab} ${o==="text"?l.active:""}`,onClick:()=>a("text"),children:t("import_from_text")}),s("button",{className:`${l.tab} ${o==="url"?l.active:""}`,onClick:()=>a("url"),children:t("import_from_url")})]}),h&&s("div",{className:`${l.message} ${l[h.type]}`,children:h.text}),o==="manual"&&ut(),o==="url"&&dt(),o==="text"&&pt(),s("div",{style:{marginTop:"20px",textAlign:"center"},children:s("button",{className:`${l.button} ${l.secondary}`,onClick:lt,disabled:c,children:"📥 导出配置文件"})})]})}const Po=e=>({apiConfig:_e(e),groupNames:qe(e)}),To=B(Po)(Oo);function Eo({color:e="currentColor",size:r=24}){return u("svg",{fill:"none",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:r,height:r,stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[s("path",{d:"M2 6h9M18.5 6H22"}),s("circle",{cx:"16",cy:"6",r:"2"}),s("path",{d:"M22 18h-9M6 18H2"}),s("circle",{r:"2",transform:"matrix(-1 0 0 1 8 18)"})]})}const $o="_topBar_15n7g_4",So="_topBarRight_15n7g_16",Ro="_textFilterContainer_15n7g_25",Lo="_group_15n7g_32",Z={topBar:$o,topBarRight:So,textFilterContainer:Ro,group:Lo},{useState:De,useEffect:Mo,useCallback:le,useRef:zo}=R;function Ao({dispatch:e,groupNames:r,delay:n,proxyProviders:t,apiConfig:o,showModalClosePrevConns:a}){const c=zo({}),p=le(()=>{c.current.startAt=Date.now(),e(Q(o)).then(()=>{c.current.completeAt=Date.now()})},[o,e]);Mo(()=>{p();const w=()=>{c.current.startAt&&Date.now()-c.current.startAt>3e4&&p()};return window.addEventListener("focus",w,!1),()=>window.removeEventListener("focus",w,!1)},[p]);const[h,m]=De(!1),[i,f]=De(!1),_=le(()=>{m(!1)},[]),y=le(()=>{f(!1)},[]),{proxies:{closeModalClosePrevConns:v,closePrevConnsAndTheModal:N}}=V(),{t:g}=ne();return u(M,{children:[s(ae,{isOpen:h,onRequestClose:_,children:s(Hn,{})}),s(ae,{isOpen:i,onRequestClose:y,children:s(To,{})}),u("div",{className:Z.topBar,children:[s(Ue,{title:g("Proxies")}),u("div",{className:Z.topBarRight,children:[s("div",{className:Z.textFilterContainer,children:s(Wt,{textAtom:Be,placeholder:g("Search")})}),s(Pe,{label:g("add_proxy"),children:s(T,{kind:"minimal",onClick:()=>f(!0),children:s(He,{size:16})})}),s(Pe,{label:g("settings"),children:s(T,{kind:"minimal",onClick:()=>m(!0),children:s(Eo,{size:16})})})]})]}),s("div",{children:r.map(w=>s("div",{className:Z.group,children:s(Jr,{name:w,delay:n,apiConfig:o,dispatch:e})},w))}),s(Gn,{items:t}),s("div",{style:{height:60}}),s(sn,{dispatch:e,apiConfig:o,proxyProviders:t}),s(ae,{isOpen:a,onRequestClose:v,children:s(ir,{onClickPrimaryButton:()=>N(o),onClickSecondaryButton:v})})]})}const jo=e=>({apiConfig:_e(e),groupNames:qe(e),proxyProviders:At(e),delay:ve(e),showModalClosePrevConns:jt(e)}),Ho=B(jo)(Ao);export{Ho as default};
