import{r as z,R as k,p as w,b as o,j as l,B as $,x as L,a2 as ft,a3 as mt,a4 as Ie,a5 as vt,d as I,c as F,a6 as yt,N as R,a7 as gt,a8 as We,a9 as be,Q as Ue,L as _t,E as H,aa as bt,ab as xt,ac as V,O as wt,ad as qe,ae as xe,af as we,ag as Ct,ah as kt,u as Z,ai as Ot,aj as He,ak as Nt,g as se,C as Ke,S as Te,al as Pt,am as $t,an as Ce,ao as Tt,ap as Et,aq as St,ar as Ee,as as Rt,at as zt}from"./index-01af9754.js";import{C as he,B as ce}from"./BaseModal-ae9eadef.js";import{F as Lt,p as Mt,A as At,I as jt}from"./Fab-721f1f59.js";import{R as Dt,T as Gt}from"./TextFitler-b12e2eb3.js";import{f as Bt}from"./index-84fa0cb3.js";import{R as Ft}from"./rotate-cw-747b701a.js";import{S as It}from"./Select-f4ee9c18.js";import{T as J}from"./trash-2-88b9306a.js";import"./debounce-c1ba2006.js";function fe(){return fe=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])}return e},fe.apply(this,arguments)}function Wt(e,r){if(e==null)return{};var n=Ut(e,r),t,s;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(s=0;s<a.length;s++)t=a[s],!(r.indexOf(t)>=0)&&Object.prototype.propertyIsEnumerable.call(e,t)&&(n[t]=e[t])}return n}function Ut(e,r){if(e==null)return{};var n={},t=Object.keys(e),s,a;for(a=0;a<t.length;a++)s=t[a],!(r.indexOf(s)>=0)&&(n[s]=e[s]);return n}var ke=z.forwardRef(function(e,r){var n=e.color,t=n===void 0?"currentColor":n,s=e.size,a=s===void 0?24:s,c=Wt(e,["color","size"]);return k.createElement("svg",fe({ref:r,xmlns:"http://www.w3.org/2000/svg",width:a,height:a,viewBox:"0 0 24 24",fill:"none",stroke:t,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},c),k.createElement("path",{d:"M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"}),k.createElement("line",{x1:"12",y1:"9",x2:"12",y2:"13"}),k.createElement("line",{x1:"12",y1:"17",x2:"12.01",y2:"17"}))});ke.propTypes={color:w.string,size:w.oneOfType([w.string,w.number])};ke.displayName="AlertTriangle";const qt=ke;function me(){return me=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])}return e},me.apply(this,arguments)}function Ht(e,r){if(e==null)return{};var n=Kt(e,r),t,s;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(s=0;s<a.length;s++)t=a[s],!(r.indexOf(t)>=0)&&Object.prototype.propertyIsEnumerable.call(e,t)&&(n[t]=e[t])}return n}function Kt(e,r){if(e==null)return{};var n={},t=Object.keys(e),s,a;for(a=0;a<t.length;a++)s=t[a],!(r.indexOf(s)>=0)&&(n[s]=e[s]);return n}var Oe=z.forwardRef(function(e,r){var n=e.color,t=n===void 0?"currentColor":n,s=e.size,a=s===void 0?24:s,c=Ht(e,["color","size"]);return k.createElement("svg",me({ref:r,xmlns:"http://www.w3.org/2000/svg",width:a,height:a,viewBox:"0 0 24 24",fill:"none",stroke:t,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},c),k.createElement("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),k.createElement("polyline",{points:"14 2 14 8 20 8"}),k.createElement("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),k.createElement("line",{x1:"16",y1:"17",x2:"8",y2:"17"}),k.createElement("polyline",{points:"10 9 9 9 8 9"}))});Oe.propTypes={color:w.string,size:w.oneOfType([w.string,w.number])};Oe.displayName="FileText";const Vt=Oe;function ve(){return ve=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])}return e},ve.apply(this,arguments)}function Yt(e,r){if(e==null)return{};var n=Zt(e,r),t,s;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(s=0;s<a.length;s++)t=a[s],!(r.indexOf(t)>=0)&&Object.prototype.propertyIsEnumerable.call(e,t)&&(n[t]=e[t])}return n}function Zt(e,r){if(e==null)return{};var n={},t=Object.keys(e),s,a;for(a=0;a<t.length;a++)s=t[a],!(r.indexOf(s)>=0)&&(n[s]=e[s]);return n}var Ne=z.forwardRef(function(e,r){var n=e.color,t=n===void 0?"currentColor":n,s=e.size,a=s===void 0?24:s,c=Yt(e,["color","size"]);return k.createElement("svg",ve({ref:r,xmlns:"http://www.w3.org/2000/svg",width:a,height:a,viewBox:"0 0 24 24",fill:"none",stroke:t,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},c),k.createElement("path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"}),k.createElement("path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"}))});Ne.propTypes={color:w.string,size:w.oneOfType([w.string,w.number])};Ne.displayName="Link";const Qt=Ne;function ye(){return ye=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])}return e},ye.apply(this,arguments)}function Xt(e,r){if(e==null)return{};var n=Jt(e,r),t,s;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(s=0;s<a.length;s++)t=a[s],!(r.indexOf(t)>=0)&&Object.prototype.propertyIsEnumerable.call(e,t)&&(n[t]=e[t])}return n}function Jt(e,r){if(e==null)return{};var n={},t=Object.keys(e),s,a;for(a=0;a<t.length;a++)s=t[a],!(r.indexOf(s)>=0)&&(n[s]=e[s]);return n}var Pe=z.forwardRef(function(e,r){var n=e.color,t=n===void 0?"currentColor":n,s=e.size,a=s===void 0?24:s,c=Xt(e,["color","size"]);return k.createElement("svg",ye({ref:r,xmlns:"http://www.w3.org/2000/svg",width:a,height:a,viewBox:"0 0 24 24",fill:"none",stroke:t,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},c),k.createElement("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),k.createElement("line",{x1:"5",y1:"12",x2:"19",y2:"12"}))});Pe.propTypes={color:w.string,size:w.oneOfType([w.string,w.number])};Pe.displayName="Plus";const Ve=Pe;function ge(){return ge=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])}return e},ge.apply(this,arguments)}function er(e,r){if(e==null)return{};var n=tr(e,r),t,s;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(s=0;s<a.length;s++)t=a[s],!(r.indexOf(t)>=0)&&Object.prototype.propertyIsEnumerable.call(e,t)&&(n[t]=e[t])}return n}function tr(e,r){if(e==null)return{};var n={},t=Object.keys(e),s,a;for(a=0;a<t.length;a++)s=t[a],!(r.indexOf(s)>=0)&&(n[s]=e[s]);return n}var $e=z.forwardRef(function(e,r){var n=e.color,t=n===void 0?"currentColor":n,s=e.size,a=s===void 0?24:s,c=er(e,["color","size"]);return k.createElement("svg",ge({ref:r,xmlns:"http://www.w3.org/2000/svg",width:a,height:a,viewBox:"0 0 24 24",fill:"none",stroke:t,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},c),k.createElement("polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2"}))});$e.propTypes={color:w.string,size:w.oneOfType([w.string,w.number])};$e.displayName="Zap";const Y=$e,rr="_FlexCenter_1380a_1",nr={FlexCenter:rr};function or({children:e}){return o("div",{className:nr.FlexCenter,children:e})}const{useRef:Se,useEffect:sr}=L;function ar({onClickPrimaryButton:e,onClickSecondaryButton:r}){const n=Se(null),t=Se(null);return sr(()=>{n.current.focus()},[]),l("div",{onKeyDown:a=>{a.keyCode===39?t.current.focus():a.keyCode===37&&n.current.focus()},children:[o("h2",{children:"Close Connections?"}),o("p",{children:"Click 'Yes' to close those connections that are still using the old selected proxy in this group"}),o("div",{style:{height:30}}),l(or,{children:[o($,{onClick:e,ref:n,children:"Yes"}),o("div",{style:{width:20}}),o($,{onClick:r,ref:t,children:"No"})]})]})}const ir="_header_19ilz_1",lr="_arrow_19ilz_9",cr="_isOpen_19ilz_14",ur="_btn_19ilz_21",dr="_qty_19ilz_26",Re={header:ir,arrow:lr,isOpen:cr,btn:ur,qty:dr};function Ye({name:e,type:r,toggle:n,qty:t}){const s=z.useCallback(a=>{a.preventDefault(),(a.key==="Enter"||a.key===" ")&&n()},[n]);return l("div",{className:Re.header,onClick:n,style:{cursor:"pointer"},tabIndex:0,onKeyDown:s,role:"button",children:[o("div",{children:o(ft,{name:e,type:r})}),typeof t=="number"?o("span",{className:Re.qty,children:t}):null]})}const{useMemo:pr}=L;function hr(e,r){return e.filter(n=>{const t=r[n];return t===void 0?!0:t.number!==0})}const Q=(e,r)=>{if(e&&typeof e.number=="number"&&e.number>0)return e.number;const n=r&&r.type;return n&&vt.indexOf(n)>-1?-1:999999},fr={Natural:e=>e,LatencyAsc:(e,r,n)=>e.sort((t,s)=>{const a=Q(r[t],n&&n[t]),c=Q(r[s],n&&n[s]);return a-c}),LatencyDesc:(e,r,n)=>e.sort((t,s)=>{const a=Q(r[t],n&&n[t]);return Q(r[s],n&&n[s])-a}),NameAsc:e=>e.sort(),NameDesc:e=>e.sort((r,n)=>r>n?-1:r<n?1:0)};function mr(e,r){const n=r.toLowerCase().split(" ").map(t=>t.trim()).filter(t=>!!t);return n.length===0?e:e.filter(t=>{let s=0;for(;s<n.length;s++){const a=n[s];if(t.toLowerCase().indexOf(a)>-1)return!0}return!1})}function vr(e,r,n,t,s,a){let c=[...e];return n&&(c=hr(e,r)),typeof t=="string"&&t!==""&&(c=mr(c,t)),fr[s](c,r,a)}function Ze(e,r,n,t,s){const[a]=mt(Ie);return pr(()=>vr(e,r,n,a,t,s),[e,r,n,a,t,s])}const yr="_header_1qjca_1",gr="_group_1qjca_5",_r="_zapWrapper_1qjca_12",br="_arrow_1qjca_20",xr="_isOpen_1qjca_25",S={header:yr,group:gr,zapWrapper:_r,arrow:br,isOpen:xr},Qe={Right:39,Left:37,Enter:13,Space:32},wr="_proxy_xgbmr_4",Cr="_now_xgbmr_25",kr="_error_xgbmr_29",Or="_selectable_xgbmr_32",Nr="_proxyType_xgbmr_40",Pr="_udpType_xgbmr_50",$r="_tfoType_xgbmr_61",Tr="_row_xgbmr_65",Er="_proxyName_xgbmr_73",Sr="_proxySmall_xgbmr_84",P={proxy:wr,now:Cr,error:kr,selectable:Or,proxyType:Nr,udpType:Pr,tfoType:$r,row:Tr,proxyName:Er,proxySmall:Sr},Rr="_proxyLatency_1h5y2_4",zr={proxyLatency:Rr};function Lr({number:e,color:r}){return o("span",{className:zr.proxyLatency,style:{color:r},children:l("span",{children:[e," ms"]})})}const{useMemo:te}=L,K={good:"#67c23a",normal:"#d4b75c",bad:"#e67f3c",na:"#909399"};function Xe({number:e}={},r){const n={good:r?800:200,normal:r?1500:500};return e===0?K.na:e<n.good?K.good:e<n.normal?K.normal:typeof e=="number"?K.bad:K.na}function Mr(e,r){return Xe(e,r)}function Ar({now:e,name:r,proxy:n,latency:t,httpsLatencyTest:s,isSelectable:a,onClick:c}){var b;const h=(b=n.history[n.history.length-1])==null?void 0:b.delay,p=(t==null?void 0:t.number)??h,_=te(()=>Mr({number:p},s),[p]),u=te(()=>{let y=r;return t&&typeof t.number=="number"&&(y+=" "+t.number+" ms"),y},[r,t]),m=z.useCallback(()=>{a&&c&&c(r)},[r,c,a]),v=z.useCallback(y=>{y.keyCode===Qe.Enter&&m()},[m]);return o("div",{title:u,className:F(P.proxySmall,{[P.selectable]:a}),style:{background:_,scale:e?"1.2":"1"},onClick:m,onKeyDown:v,role:a?"menuitem":"",children:e&&o("div",{className:P.now})})}function jr(e){return e==="Shadowsocks"?"SS":e}const Dr=e=>({left:e.left+window.scrollX-5,top:e.top+window.scrollY-38});function Gr({children:e,label:r,"aria-label":n}){const[t,s]=yt();return l(R,{children:[z.cloneElement(e,t),o(gt,{...s,label:r,"aria-label":n,position:Dr})]})}function Br({now:e,name:r,proxy:n,latency:t,httpsLatencyTest:s,isSelectable:a,onClick:c}){var O;const h=(O=n.history[n.history.length-1])==null?void 0:O.delay,p=(t==null?void 0:t.number)??h,_=te(()=>Xe({number:p},s),[p]),u=z.useCallback(()=>{a&&c&&c(r)},[r,c,a]);function m(x,C){return x?C?"XUDP":"UDP":""}function v(x){return x?o("svg",{viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"2962",width:"10",height:"10",children:o("path",{d:"M648.093513 719.209284l-1.492609-40.940127 31.046263-26.739021c202.73892-174.805813 284.022131-385.860697 255.70521-561.306199-176.938111-28.786027-389.698834 51.857494-563.907604 254.511123l-26.31256 30.619803-40.38573-0.938211c-60.557271-1.407317-111.903014 12.79379-162.822297 47.0385l189.561318 127.084977-37.95491 68.489421c-9.126237 16.461343-0.554398 53.307457 29.084549 82.818465 29.5963 29.511008 67.380626 38.381369 83.287571 29.852176l68.318836-36.760822 127.639376 191.267156c36.163779-52.11337 50.450177-103.629696 48.189941-165.039887zM994.336107 16.105249l10.490908 2.686696 2.64405 10.405615c47.46496 178.089552-1.023503 451.492838-274.170913 686.898568 4.051367 111.263324-35.396151 200.222809-127.255561 291.741051l-15.779008 15.693715-145.934494-218.731157c-51.217805 27.59194-128.790816 10.405616-183.93205-44.522388-55.226525-55.013296-72.41285-132.287785-43.498885-184.529093L0.002773 430.325513l15.736362-15.65107c89.300652-88.959484 178.64395-128.108481 289.011709-125.549722C539.730114 15.806727 815.56422-31.061189 994.336107 16.105249zM214.93844 805.098259c28.572797 28.572797 22.346486 79.49208-12.537914 114.376479C156.428175 965.489735 34.034254 986.002445 34.034254 986.002445s25.331704-127.084978 66.612998-168.323627c34.8844-34.8844 85.633099-41.281295 114.291188-12.580559zM661.01524 298.549479a63.968948 63.968948 0 1 0 0 127.937897 63.968948 63.968948 0 0 0 0-127.937897z","p-id":"2963"})}):""}const b=z.useCallback(x=>{x.keyCode===Qe.Enter&&u()},[u]),y=te(()=>F(P.proxy,{[P.now]:e,[P.error]:t&&t.error,[P.selectable]:a}),[a,e,t]);return l("div",{tabIndex:0,className:y,onClick:u,onKeyDown:b,role:a?"menuitem":"",children:[l("div",{className:F(P.proxyName,P.row),children:[o(Gr,{label:r,"aria-label":`proxy name: ${r}`,children:o("span",{children:r})}),o("span",{className:P.proxyType,style:{paddingLeft:4,opacity:.6,color:"#51A8DD"},children:m(n.udp,n.xudp)})]}),l("div",{className:P.row,children:[l("div",{className:P.row,children:[o("span",{className:P.proxyType,style:{paddingRight:4,opacity:.6,color:"#F596AA"},children:jr(n.type)}),v(n.tfo)]}),p?o(Lr,{number:p,color:_}):null]})]})}const Je=(e,{name:r})=>{const n=We(e),t=be(e),s=Ue(e);return{proxy:n[r]||{name:r,history:[]},latency:t[r],httpsLatencyTest:s.startsWith("https://")}},Fr=I(Je)(Br),Ir=I(Je)(Ar),Wr="_list_4awfc_4",Ur="_detail_4awfc_10",qr="_summary_4awfc_19",re={list:Wr,detail:Ur,summary:qr};function et({all:e,now:r,isSelectable:n,itemOnTapCallback:t}){const s=e;return o("div",{className:F(re.list,re.detail),children:s.map(a=>o(Fr,{onClick:t,isSelectable:n,name:a,now:a===r},a))})}function tt({all:e,now:r,isSelectable:n,itemOnTapCallback:t}){return o("div",{className:F(re.list,re.summary),children:e.map(s=>o(Ir,{onClick:t,isSelectable:n,name:s,now:s===r},s))})}const{createElement:Hr,useCallback:ue,useMemo:Kr,useState:ze,useEffect:Vr}=L;function Le(){return o("div",{className:S.zapWrapper,children:o(Y,{size:16})})}function Yr({name:e,all:r,delay:n,hideUnavailableProxies:t,proxySortBy:s,proxies:a,type:c,now:h,isOpen:p,latencyTestUrl:_,apiConfig:u,dispatch:m}){const v=Ze(r,n,t,s,a),{data:b}=_t(["/version",u],()=>wt("/version",u)),y=Kr(()=>["Selector",b.meta&&"Fallback",b.meta&&"URLTest"].includes(c),[c,b.meta]),{app:{updateCollapsibleIsOpen:O},proxies:{requestDelayForProxies:x}}=H(),C=ue(()=>{O("proxyGroup",e,!p)},[p,O,e]),E=ue(D=>{y&&m(bt(u,e,D))},[u,m,e,y]),[T,N]=ze(!1),A=ue(async()=>{N(!0);try{b.meta===!0?(await xt(u,e,_),await m(V(u))):(await x(u,v),await m(V(u)))}catch{}N(!1)},[v,u,m,e,b.meta]),[j,f]=ze(window.innerWidth),g=()=>{f(window.innerWidth)};return Vr(()=>(window.addEventListener("resize",g),()=>window.removeEventListener("resize",g)),[]),l("div",{className:S.group,children:[l("div",{style:{display:"flex",alignItems:"center",justifyContent:j>768?"start":"space-between"},children:[o(Ye,{name:e,type:c,toggle:C,qty:v.length}),o("div",{style:{display:"flex"},children:j>768?l(R,{children:[o($,{kind:"minimal",onClick:C,className:S.btn,title:"Toggle collapsible section",children:o("span",{className:F(S.arrow,{[S.isOpen]:p}),children:o(he,{size:20})})}),o($,{title:"Test latency",kind:"minimal",onClick:A,isLoading:T,children:o(Le,{})})]}):l(R,{children:[o($,{title:"Test latency",kind:"minimal",onClick:A,isLoading:T,children:o(Le,{})}),o($,{kind:"minimal",onClick:C,className:S.btn,title:"Toggle collapsible section",children:o("span",{className:F(S.arrow,{[S.isOpen]:p}),children:o(he,{size:20})})})]})})]}),Hr(p?et:tt,{all:v,now:h,isSelectable:y,itemOnTapCallback:E})]})}const Zr=I((e,{name:r,delay:n})=>{const t=We(e),s=qe(e),a=xe(e),c=we(e),h=Ue(e),p=t[r],{all:_,type:u,now:m}=p;return{all:_,delay:n,hideUnavailableProxies:c,proxySortBy:a,proxies:t,type:u,now:m,isOpen:s[`proxyGroup:${r}`],latencyTestUrl:h}})(Yr),{useCallback:rt,useState:Qr}=L;function Xr({dispatch:e,apiConfig:r,name:n}){return rt(()=>e(Ct(r,n)),[r,e,n])}function Jr({dispatch:e,apiConfig:r,names:n}){const[t,s]=Qr(!1);return[rt(async()=>{if(!t){s(!0);try{await e(kt(r,n))}catch{}s(!1)}},[r,e,n,t]),t]}const{useState:en,useCallback:tn}=L;function rn({isLoading:e}){return e?o(jt,{children:o(Y,{width:16,height:16})}):o(Y,{width:16,height:16})}function nn({dispatch:e,apiConfig:r}){const[n,t]=en(!1);return[tn(()=>{n||(t(!0),e(Ot(r)).then(()=>t(!1),()=>t(!1)))},[r,e,n]),n]}function on({dispatch:e,apiConfig:r,proxyProviders:n}){const{t}=Z(),[s,a]=nn({dispatch:e,apiConfig:r}),[c,h]=Jr({apiConfig:r,dispatch:e,names:n.map(p=>p.name)});return o(Lt,{icon:o(rn,{isLoading:a}),onClick:s,text:t("Test Latency"),style:Mt,children:n.length>0?o(At,{text:t("update_all_proxy_provider"),onClick:c,children:o(Dt,{isRotating:h})}):null})}var nt=function(){if(typeof Map<"u")return Map;function e(r,n){var t=-1;return r.some(function(s,a){return s[0]===n?(t=a,!0):!1}),t}return function(){function r(){this.__entries__=[]}return Object.defineProperty(r.prototype,"size",{get:function(){return this.__entries__.length},enumerable:!0,configurable:!0}),r.prototype.get=function(n){var t=e(this.__entries__,n),s=this.__entries__[t];return s&&s[1]},r.prototype.set=function(n,t){var s=e(this.__entries__,n);~s?this.__entries__[s][1]=t:this.__entries__.push([n,t])},r.prototype.delete=function(n){var t=this.__entries__,s=e(t,n);~s&&t.splice(s,1)},r.prototype.has=function(n){return!!~e(this.__entries__,n)},r.prototype.clear=function(){this.__entries__.splice(0)},r.prototype.forEach=function(n,t){t===void 0&&(t=null);for(var s=0,a=this.__entries__;s<a.length;s++){var c=a[s];n.call(t,c[1],c[0])}},r}()}(),_e=typeof window<"u"&&typeof document<"u"&&window.document===document,ne=function(){return typeof global<"u"&&global.Math===Math?global:typeof self<"u"&&self.Math===Math?self:typeof window<"u"&&window.Math===Math?window:Function("return this")()}(),sn=function(){return typeof requestAnimationFrame=="function"?requestAnimationFrame.bind(ne):function(e){return setTimeout(function(){return e(Date.now())},1e3/60)}}(),an=2;function ln(e,r){var n=!1,t=!1,s=0;function a(){n&&(n=!1,e()),t&&h()}function c(){sn(a)}function h(){var p=Date.now();if(n){if(p-s<an)return;t=!0}else n=!0,t=!1,setTimeout(c,r);s=p}return h}var cn=20,un=["top","right","bottom","left","width","height","size","weight"],dn=typeof MutationObserver<"u",pn=function(){function e(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=ln(this.refresh.bind(this),cn)}return e.prototype.addObserver=function(r){~this.observers_.indexOf(r)||this.observers_.push(r),this.connected_||this.connect_()},e.prototype.removeObserver=function(r){var n=this.observers_,t=n.indexOf(r);~t&&n.splice(t,1),!n.length&&this.connected_&&this.disconnect_()},e.prototype.refresh=function(){var r=this.updateObservers_();r&&this.refresh()},e.prototype.updateObservers_=function(){var r=this.observers_.filter(function(n){return n.gatherActive(),n.hasActive()});return r.forEach(function(n){return n.broadcastActive()}),r.length>0},e.prototype.connect_=function(){!_e||this.connected_||(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),dn?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},e.prototype.disconnect_=function(){!_e||!this.connected_||(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},e.prototype.onTransitionEnd_=function(r){var n=r.propertyName,t=n===void 0?"":n,s=un.some(function(a){return!!~t.indexOf(a)});s&&this.refresh()},e.getInstance=function(){return this.instance_||(this.instance_=new e),this.instance_},e.instance_=null,e}(),ot=function(e,r){for(var n=0,t=Object.keys(r);n<t.length;n++){var s=t[n];Object.defineProperty(e,s,{value:r[s],enumerable:!1,writable:!1,configurable:!0})}return e},q=function(e){var r=e&&e.ownerDocument&&e.ownerDocument.defaultView;return r||ne},st=ae(0,0,0,0);function oe(e){return parseFloat(e)||0}function Me(e){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];return r.reduce(function(t,s){var a=e["border-"+s+"-width"];return t+oe(a)},0)}function hn(e){for(var r=["top","right","bottom","left"],n={},t=0,s=r;t<s.length;t++){var a=s[t],c=e["padding-"+a];n[a]=oe(c)}return n}function fn(e){var r=e.getBBox();return ae(0,0,r.width,r.height)}function mn(e){var r=e.clientWidth,n=e.clientHeight;if(!r&&!n)return st;var t=q(e).getComputedStyle(e),s=hn(t),a=s.left+s.right,c=s.top+s.bottom,h=oe(t.width),p=oe(t.height);if(t.boxSizing==="border-box"&&(Math.round(h+a)!==r&&(h-=Me(t,"left","right")+a),Math.round(p+c)!==n&&(p-=Me(t,"top","bottom")+c)),!yn(e)){var _=Math.round(h+a)-r,u=Math.round(p+c)-n;Math.abs(_)!==1&&(h-=_),Math.abs(u)!==1&&(p-=u)}return ae(s.left,s.top,h,p)}var vn=function(){return typeof SVGGraphicsElement<"u"?function(e){return e instanceof q(e).SVGGraphicsElement}:function(e){return e instanceof q(e).SVGElement&&typeof e.getBBox=="function"}}();function yn(e){return e===q(e).document.documentElement}function gn(e){return _e?vn(e)?fn(e):mn(e):st}function _n(e){var r=e.x,n=e.y,t=e.width,s=e.height,a=typeof DOMRectReadOnly<"u"?DOMRectReadOnly:Object,c=Object.create(a.prototype);return ot(c,{x:r,y:n,width:t,height:s,top:n,right:r+t,bottom:s+n,left:r}),c}function ae(e,r,n,t){return{x:e,y:r,width:n,height:t}}var bn=function(){function e(r){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=ae(0,0,0,0),this.target=r}return e.prototype.isActive=function(){var r=gn(this.target);return this.contentRect_=r,r.width!==this.broadcastWidth||r.height!==this.broadcastHeight},e.prototype.broadcastRect=function(){var r=this.contentRect_;return this.broadcastWidth=r.width,this.broadcastHeight=r.height,r},e}(),xn=function(){function e(r,n){var t=_n(n);ot(this,{target:r,contentRect:t})}return e}(),wn=function(){function e(r,n,t){if(this.activeObservations_=[],this.observations_=new nt,typeof r!="function")throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=r,this.controller_=n,this.callbackCtx_=t}return e.prototype.observe=function(r){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if(!(typeof Element>"u"||!(Element instanceof Object))){if(!(r instanceof q(r).Element))throw new TypeError('parameter 1 is not of type "Element".');var n=this.observations_;n.has(r)||(n.set(r,new bn(r)),this.controller_.addObserver(this),this.controller_.refresh())}},e.prototype.unobserve=function(r){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if(!(typeof Element>"u"||!(Element instanceof Object))){if(!(r instanceof q(r).Element))throw new TypeError('parameter 1 is not of type "Element".');var n=this.observations_;n.has(r)&&(n.delete(r),n.size||this.controller_.removeObserver(this))}},e.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},e.prototype.gatherActive=function(){var r=this;this.clearActive(),this.observations_.forEach(function(n){n.isActive()&&r.activeObservations_.push(n)})},e.prototype.broadcastActive=function(){if(this.hasActive()){var r=this.callbackCtx_,n=this.activeObservations_.map(function(t){return new xn(t.target,t.broadcastRect())});this.callback_.call(r,n,r),this.clearActive()}},e.prototype.clearActive=function(){this.activeObservations_.splice(0)},e.prototype.hasActive=function(){return this.activeObservations_.length>0},e}(),at=typeof WeakMap<"u"?new WeakMap:new nt,it=function(){function e(r){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var n=pn.getInstance(),t=new wn(r,n,this);at.set(this,t)}return e}();["observe","unobserve","disconnect"].forEach(function(e){it.prototype[e]=function(){var r;return(r=at.get(this))[e].apply(r,arguments)}});var Cn=function(){return typeof ne.ResizeObserver<"u"?ne.ResizeObserver:it}();const{memo:kn,useState:On,useRef:lt,useEffect:ct}=k;function Nn(e){const r=lt();return ct(()=>void(r.current=e),[e]),r.current}function Pn(){const e=lt(),[r,n]=On({height:0});return ct(()=>{const t=new Cn(([s])=>n(s.contentRect));return e.current&&t.observe(e.current),()=>t.disconnect()},[]),[e,r]}const $n={initialOpen:{height:"auto",transition:{duration:0}},open:e=>({height:e,opacity:1,visibility:"visible",transition:{duration:.3}}),closed:{height:0,opacity:0,visibility:"hidden",overflowY:"hidden",transition:{duration:.3}}},Tn={open:{},closed:{}},Ae=kn(({children:e,isOpen:r})=>{const t=He.read().motion,s=Nn(r),[a,{height:c}]=Pn();return o("div",{children:o(t.div,{animate:r&&s===r?"initialOpen":r?"open":"closed",custom:c,variants:$n,children:o(t.div,{variants:Tn,ref:a,children:e})})})}),En="_updatedAt_1d817_4",Sn="_body_1d817_12",Rn="_actionFooter_1d817_25",zn="_refresh_1d817_35",ee={updatedAt:En,body:Sn,actionFooter:Rn,refresh:zn},{useState:Ln,useCallback:je}=L;function Mn({name:e,proxies:r,delay:n,hideUnavailableProxies:t,proxySortBy:s,vehicleType:a,updatedAt:c,subscriptionInfo:h,isOpen:p,dispatch:_,apiConfig:u}){const m=Ze(r,n,t,s),[v,b]=Ln(!1),y=Xr({dispatch:_,apiConfig:u,name:e}),O=je(async()=>{b(!0),await _(Nt(u,e)),b(!1)},[u,_,e,b]),{app:{updateCollapsibleIsOpen:x}}=H(),C=je(()=>{x("proxyProvider",e,!p)},[p,x,e]),E=Bt(new Date(c),new Date),T=h?De(h.Total):0,N=h?De(h.Download+h.Upload):0,A=h?((h.Download+h.Upload)/h.Total*100).toFixed(2):0,j=()=>{if(h.Expire===0)return"Null";const f=new Date(h.Expire*1e3),g=f.getFullYear()+"-",D=(f.getMonth()+1<10?"0"+(f.getMonth()+1):f.getMonth()+1)+"-",ie=(f.getDate()<10?"0"+f.getDate():f.getDate())+" ";return g+D+ie};return l("div",{className:ee.body,children:[l("div",{style:{display:"flex",alignItems:"center",flexWrap:"wrap",justifyContent:"space-between"},children:[o(Ye,{name:e,toggle:C,type:a,isOpen:p,qty:m.length}),l("div",{style:{display:"flex"},children:[o($,{kind:"minimal",onClick:C,className:S.btn,title:"Toggle collapsible section",children:o("span",{className:F(S.arrow,{[S.isOpen]:p}),children:o(he,{size:20})})}),o($,{kind:"minimal",start:o(Ge,{}),onClick:y}),o($,{kind:"minimal",start:o(Y,{size:16}),onClick:O,isLoading:v})]})]}),l("div",{className:ee.updatedAt,children:[h&&l("small",{children:[N," / ",T," ( ",A,"% )    Expire: ",j()," "]}),o("br",{}),l("small",{children:["Updated ",E," ago"]})]}),l(Ae,{isOpen:p,children:[o(et,{all:m}),l("div",{className:ee.actionFooter,children:[o($,{text:"Update",start:o(Ge,{}),onClick:y}),o($,{text:"Health Check",start:o(Y,{size:16}),onClick:O,isLoading:v})]})]}),o(Ae,{isOpen:!p,children:o(tt,{all:m})})]})}const An={rest:{scale:1},pressed:{scale:.95}},jn={rest:{rotate:0},hover:{rotate:360,transition:{duration:.3}}};function De(e,r=2){if(!+e)return"0 Bytes";const n=1024,t=r<0?0:r,s=["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"],a=Math.floor(Math.log(e)/Math.log(n));return`${parseFloat((e/Math.pow(n,a)).toFixed(t))} ${s[a]}`}function Ge(){const r=He.read().motion;return o(r.div,{className:ee.refresh,variants:An,initial:"rest",whileHover:"hover",whileTap:"pressed",children:o(r.div,{className:"flexCenter",variants:jn,children:o(Ft,{size:16})})})}const Dn=(e,{proxies:r,name:n})=>{const t=we(e),s=be(e),a=qe(e),c=se(e),h=xe(e);return{apiConfig:c,proxies:r,delay:s,hideUnavailableProxies:t,proxySortBy:h,isOpen:a[`proxyProvider:${n}`]}},Gn=I(Dn)(Mn);function Bn({items:e}){return e.length===0?null:l(R,{children:[o(Ke,{title:"Proxy Provider"}),o("div",{children:e.map(r=>o(Gn,{name:r.name,proxies:r.proxies,type:r.type,vehicleType:r.vehicleType,updatedAt:r.updatedAt,subscriptionInfo:r.subscriptionInfo},r.name))})]})}const Fn="_labeledInput_cmki0_1",de={labeledInput:Fn},In=[["Natural","order_natural"],["LatencyAsc","order_latency_asc"],["LatencyDesc","order_latency_desc"],["NameAsc","order_name_asc"],["NameDesc","order_name_desc"]],{useCallback:Be}=L;function Wn({appConfig:e}){const{app:{updateAppConfig:r}}=H(),n=Be(a=>{r("proxySortBy",a.target.value)},[r]),t=Be(a=>{r("hideUnavailableProxies",a)},[r]),{t:s}=Z();return l(R,{children:[l("div",{className:de.labeledInput,children:[o("span",{children:s("sort_in_grp")}),o("div",{children:o(It,{options:In.map(a=>[a[0],s(a[1])]),selected:e.proxySortBy,onChange:n})})]}),o("hr",{}),l("div",{className:de.labeledInput,children:[o("span",{children:s("hide_unavail_proxies")}),o("div",{children:o(Te,{name:"hideUnavailableProxies",checked:e.hideUnavailableProxies,onChange:t})})]}),l("div",{className:de.labeledInput,children:[o("span",{children:s("auto_close_conns")}),o("div",{children:o(Te,{name:"autoCloseOldConns",checked:e.autoCloseOldConns,onChange:a=>r("autoCloseOldConns",a)})})]})]})}const Un=e=>{const r=xe(e),n=we(e),t=Pt(e);return{appConfig:{proxySortBy:r,hideUnavailableProxies:n,autoCloseOldConns:t}}},qn=I(Un)(Wn),Hn="_container_p8tt0_1",Kn="_tabs_p8tt0_7",Vn="_tab_p8tt0_7",Yn="_active_p8tt0_24",Zn="_form_p8tt0_29",Qn="_formRow_p8tt0_35",Xn="_formGroup_p8tt0_41",Jn="_label_p8tt0_48",eo="_input_p8tt0_54",to="_select_p8tt0_67",ro="_textarea_p8tt0_80",no="_button_p8tt0_95",oo="_primary_p8tt0_104",so="_secondary_p8tt0_115",ao="_buttonGroup_p8tt0_124",io="_checkbox_p8tt0_131",lo="_groupSelector_p8tt0_146",co="_groupItem_p8tt0_157",uo="_message_p8tt0_172",po="_success_p8tt0_178",ho="_error_p8tt0_183",fo="_info_p8tt0_188",mo="_loading_p8tt0_194",vo="_spinner_p8tt0_202",yo="_spin_p8tt0_202",i={container:Hn,tabs:Kn,tab:Vn,active:Yn,form:Zn,formRow:Qn,formGroup:Xn,label:Jn,input:eo,select:to,textarea:ro,button:no,primary:oo,secondary:so,buttonGroup:ao,checkbox:io,groupSelector:lo,groupItem:co,message:uo,success:po,error:ho,info:fo,loading:mo,spinner:vo,spin:yo},{useState:U,useCallback:W}=L;function go({dispatch:e,groupNames:r,apiConfig:n}){const{t}=Z(),[s,a]=U(!1),[c,h]=U(null),[p,_]=U(""),[u,m]=U([]),[v,b]=U(!1),[y,O]=U(!1);H();const x=W(f=>{m(g=>g.includes(f)?g.filter(D=>D!==f):[...g,f])},[]),C=W(()=>{b(f=>!f),m([])},[]),E=W(()=>{h(null)},[]),T=W((f,g)=>{h({type:f,text:g}),setTimeout(E,5e3)},[E]),N=W(async()=>{if(!p.trim()){T("error",t("请输入要删除的节点名称"));return}const f=v?r:u;if(f.length===0){T("error",t("请选择至少一个策略组"));return}a(!0);try{await Promise.all(f.map(g=>$t(n,g,p.trim()))),await e(V(n)),T("success",t("remove_proxy_success")),_(""),m([]),b(!1),O(!1)}catch{T("error",t("remove_proxy_failed"))}finally{a(!1)}},[p,v,u,r,n,e,t]),A=W(()=>{if(!p.trim()){T("error",t("请输入要删除的节点名称"));return}O(!0)},[p,t]),j=W(()=>{O(!1)},[]);return l("div",{className:i.container,children:[l("div",{style:{display:"flex",alignItems:"center",gap:"10px",marginBottom:"20px"},children:[o(J,{size:20,color:"#f44336"}),o("h2",{style:{margin:0,color:"#f44336"},children:"删除节点"})]}),c&&o("div",{className:`${i.message} ${i[c.type]}`,children:c.text}),l("div",{className:i.form,children:[l("div",{className:i.formGroup,children:[o("label",{className:i.label,children:"节点名称"}),o("input",{type:"text",className:i.input,value:p,onChange:f=>_(f.target.value),placeholder:"输入要删除的节点名称"})]}),l("div",{className:i.checkbox,children:[o("input",{type:"checkbox",checked:v,onChange:C}),o("span",{children:t("remove_proxy_from_all_groups")})]}),!v&&l("div",{children:[o("label",{className:i.label,children:t("select_groups")}),o("div",{className:i.groupSelector,children:r.map(f=>l("div",{className:i.groupItem,children:[o("input",{type:"checkbox",checked:u.includes(f),onChange:()=>x(f)}),o("span",{children:f})]},f))})]}),y&&l("div",{className:`${i.message} ${i.error}`,style:{display:"flex",alignItems:"center",gap:"10px"},children:[o(qt,{size:16}),l("div",{children:[o("strong",{children:"确认删除"}),l("p",{style:{margin:"5px 0 0 0"},children:["确定要从 ",v?"所有策略组":`${u.length} 个策略组`,' 中删除节点 "',p,'" 吗？']})]})]}),o("div",{className:i.buttonGroup,children:y?l(R,{children:[o("button",{className:`${i.button} ${i.secondary}`,onClick:j,disabled:s,children:"取消"}),o("button",{className:`${i.button} ${i.primary}`,onClick:N,disabled:s,style:{backgroundColor:"#f44336"},children:s?l("div",{className:i.loading,children:[o("div",{className:i.spinner}),"删除中..."]}):l(R,{children:[o(J,{size:16}),"确认删除"]})})]}):l("button",{className:`${i.button} ${i.primary}`,onClick:A,disabled:s||!p.trim(),style:{backgroundColor:"#f44336"},children:[o(J,{size:16}),"删除节点"]})})]})]})}const _o=e=>({apiConfig:se(e),groupNames:Ce(e)}),bo=I(_o)(go),{useState:G,useCallback:B}=L;function xo({dispatch:e,groupNames:r,apiConfig:n}){const{t}=Z(),[s,a]=G("manual"),[c,h]=G(!1),[p,_]=G(null),[u,m]=G({name:"",type:"vmess",server:"",port:"",password:"",method:"auto",uuid:"",security:"auto",network:"tcp",sni:"",path:"",host:"",protocol:"origin",obfs:"plain",username:""}),[v,b]=G(""),[y,O]=G(""),[x,C]=G([]),[E,T]=G(!1);H();const N=B((d,M)=>{m(le=>({...le,[d]:M}))},[]),A=B(d=>{C(M=>M.includes(d)?M.filter(le=>le!==d):[...M,d])},[]),j=B(()=>{T(d=>!d),C([])},[]),f=B(()=>{_(null)},[]),g=B((d,M)=>{_({type:d,text:M}),setTimeout(f,5e3)},[f]),D=B(async()=>{if(!u.name||!u.server||!u.port){g("error",t("请填写必要的节点信息"));return}const d=E?r:x;if(d.length===0){g("error",t("请选择至少一个策略组"));return}h(!0);try{await Promise.all(d.map(M=>Tt(n,M,u.name))),await e(V(n)),g("success",t("add_proxy_success")),m({name:"",type:"vmess",server:"",port:"",password:"",method:"auto",uuid:"",security:"auto",network:"tcp",sni:"",path:"",host:"",protocol:"origin",obfs:"plain",username:""})}catch{g("error",t("add_proxy_failed"))}finally{h(!1)}},[u,E,x,r,n,e,t]),ie=B(async()=>{if(!v){g("error",t("请输入订阅链接"));return}h(!0);try{const d=await Et(v);g("success",`${t("parse_proxy_success")}，共解析出 ${d.length} 个节点`),console.log("解析的节点:",d),b("")}catch{g("error",t("parse_proxy_failed"))}finally{h(!1)}},[v,t]),ut=B(async()=>{if(!y){g("error",t("请输入节点配置文本"));return}h(!0);try{const d=St(y);g("success",`${t("parse_proxy_success")}，共解析出 ${d.length} 个节点`),console.log("解析的节点:",d),O("")}catch{g("error",t("parse_proxy_failed"))}finally{h(!1)}},[y,t]),dt=()=>l("div",{className:i.form,children:[l("div",{className:i.formRow,children:[l("div",{className:i.formGroup,children:[o("label",{className:i.label,children:t("proxy_name")}),o("input",{type:"text",className:i.input,value:u.name,onChange:d=>N("name",d.target.value),placeholder:"节点名称"})]}),l("div",{className:i.formGroup,children:[o("label",{className:i.label,children:t("proxy_type")}),l("select",{className:i.select,value:u.type,onChange:d=>N("type",d.target.value),children:[o("option",{value:"vmess",children:t("vmess")}),o("option",{value:"vless",children:t("vless")}),o("option",{value:"shadowsocks",children:t("shadowsocks")}),o("option",{value:"shadowsocksr",children:t("shadowsocksr")}),o("option",{value:"trojan",children:t("trojan")}),o("option",{value:"http",children:t("http")}),o("option",{value:"socks5",children:t("socks5")})]})]})]}),l("div",{className:i.formRow,children:[l("div",{className:i.formGroup,children:[o("label",{className:i.label,children:t("proxy_server")}),o("input",{type:"text",className:i.input,value:u.server,onChange:d=>N("server",d.target.value),placeholder:"服务器地址"})]}),l("div",{className:i.formGroup,children:[o("label",{className:i.label,children:t("proxy_port")}),o("input",{type:"text",className:i.input,value:u.port,onChange:d=>N("port",d.target.value),placeholder:"端口"})]})]}),u.type==="shadowsocks"&&l("div",{className:i.formRow,children:[l("div",{className:i.formGroup,children:[o("label",{className:i.label,children:t("proxy_password")}),o("input",{type:"password",className:i.input,value:u.password||"",onChange:d=>N("password",d.target.value),placeholder:"密码"})]}),l("div",{className:i.formGroup,children:[o("label",{className:i.label,children:t("proxy_method")}),l("select",{className:i.select,value:u.method||"auto",onChange:d=>N("method",d.target.value),children:[o("option",{value:"auto",children:t("auto")}),o("option",{value:"aes-128-gcm",children:t("aes-128-gcm")}),o("option",{value:"aes-256-gcm",children:t("aes-256-gcm")}),o("option",{value:"chacha20-poly1305",children:t("chacha20-poly1305")})]})]})]}),(u.type==="vmess"||u.type==="vless")&&l("div",{className:i.formRow,children:[l("div",{className:i.formGroup,children:[o("label",{className:i.label,children:t("proxy_uuid")}),o("input",{type:"text",className:i.input,value:u.uuid||"",onChange:d=>N("uuid",d.target.value),placeholder:"UUID"})]}),l("div",{className:i.formGroup,children:[o("label",{className:i.label,children:t("proxy_security")}),l("select",{className:i.select,value:u.security||"auto",onChange:d=>N("security",d.target.value),children:[o("option",{value:"auto",children:t("auto")}),o("option",{value:"none",children:t("none")}),o("option",{value:"tls",children:t("tls")}),o("option",{value:"xtls",children:t("xtls")})]})]})]}),l("div",{className:i.formRow,children:[l("div",{className:i.formGroup,children:[o("label",{className:i.label,children:t("proxy_network")}),l("select",{className:i.select,value:u.network||"tcp",onChange:d=>N("network",d.target.value),children:[o("option",{value:"tcp",children:t("tcp")}),o("option",{value:"ws",children:t("ws")}),o("option",{value:"h2",children:t("h2")}),o("option",{value:"grpc",children:t("grpc")})]})]}),l("div",{className:i.formGroup,children:[o("label",{className:i.label,children:t("proxy_sni")}),o("input",{type:"text",className:i.input,value:u.sni||"",onChange:d=>N("sni",d.target.value),placeholder:"SNI"})]})]}),l("div",{className:i.checkbox,children:[o("input",{type:"checkbox",checked:E,onChange:j}),o("span",{children:t("add_proxy_to_all_groups")})]}),!E&&l("div",{children:[o("label",{className:i.label,children:t("select_groups")}),o("div",{className:i.groupSelector,children:r.map(d=>l("div",{className:i.groupItem,children:[o("input",{type:"checkbox",checked:x.includes(d),onChange:()=>A(d)}),o("span",{children:d})]},d))})]}),o("div",{className:i.buttonGroup,children:o("button",{className:`${i.button} ${i.primary}`,onClick:D,disabled:c,children:c?l("div",{className:i.loading,children:[o("div",{className:i.spinner}),"添加中..."]}):l(R,{children:[o(Ve,{size:16}),t("add_proxy")]})})})]}),pt=()=>l("div",{className:i.form,children:[l("div",{className:i.formGroup,children:[o("label",{className:i.label,children:t("subscription_url")}),o("input",{type:"url",className:i.input,value:v,onChange:d=>b(d.target.value),placeholder:"https://example.com/subscription"})]}),o("div",{className:i.buttonGroup,children:o("button",{className:`${i.button} ${i.primary}`,onClick:ie,disabled:c,children:c?l("div",{className:i.loading,children:[o("div",{className:i.spinner}),"解析中..."]}):l(R,{children:[o(Qt,{size:16}),t("parse_proxy")]})})})]}),ht=()=>l("div",{className:i.form,children:[l("div",{className:i.formGroup,children:[o("label",{className:i.label,children:t("proxy_text")}),o("textarea",{className:i.textarea,value:y,onChange:d=>O(d.target.value),placeholder:`vmess://...
vless://...
ss://...`})]}),o("div",{className:i.buttonGroup,children:o("button",{className:`${i.button} ${i.primary}`,onClick:ut,disabled:c,children:c?l("div",{className:i.loading,children:[o("div",{className:i.spinner}),"解析中..."]}):l(R,{children:[o(Vt,{size:16}),t("parse_proxy")]})})})]});return l("div",{className:i.container,children:[l("div",{className:i.tabs,children:[o("button",{className:`${i.tab} ${s==="manual"?i.active:""}`,onClick:()=>a("manual"),children:t("add_proxy")}),o("button",{className:`${i.tab} ${s==="url"?i.active:""}`,onClick:()=>a("url"),children:t("import_from_url")}),o("button",{className:`${i.tab} ${s==="text"?i.active:""}`,onClick:()=>a("text"),children:t("import_from_text")}),l("button",{className:`${i.tab} ${s==="remove"?i.active:""}`,onClick:()=>a("remove"),style:{color:"#f44336"},children:[o(J,{size:16}),"删除节点"]})]}),p&&o("div",{className:`${i.message} ${i[p.type]}`,children:p.text}),s==="manual"&&dt(),s==="url"&&pt(),s==="text"&&ht(),s==="remove"&&o(bo,{dispatch:e,groupNames:r,apiConfig:n})]})}const wo=e=>({apiConfig:se(e),groupNames:Ce(e)}),Co=I(wo)(xo);function ko({color:e="currentColor",size:r=24}){return l("svg",{fill:"none",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:r,height:r,stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[o("path",{d:"M2 6h9M18.5 6H22"}),o("circle",{cx:"16",cy:"6",r:"2"}),o("path",{d:"M22 18h-9M6 18H2"}),o("circle",{r:"2",transform:"matrix(-1 0 0 1 8 18)"})]})}const Oo="_topBar_15n7g_4",No="_topBarRight_15n7g_16",Po="_textFilterContainer_15n7g_25",$o="_group_15n7g_32",X={topBar:Oo,topBarRight:No,textFilterContainer:Po,group:$o},{useState:Fe,useEffect:To,useCallback:pe,useRef:Eo}=L;function So({dispatch:e,groupNames:r,delay:n,proxyProviders:t,apiConfig:s,showModalClosePrevConns:a}){const c=Eo({}),h=pe(()=>{c.current.startAt=Date.now(),e(V(s)).then(()=>{c.current.completeAt=Date.now()})},[s,e]);To(()=>{h();const C=()=>{c.current.startAt&&Date.now()-c.current.startAt>3e4&&h()};return window.addEventListener("focus",C,!1),()=>window.removeEventListener("focus",C,!1)},[h]);const[p,_]=Fe(!1),[u,m]=Fe(!1),v=pe(()=>{_(!1)},[]),b=pe(()=>{m(!1)},[]),{proxies:{closeModalClosePrevConns:y,closePrevConnsAndTheModal:O}}=H(),{t:x}=Z();return l(R,{children:[o(ce,{isOpen:p,onRequestClose:v,children:o(qn,{})}),o(ce,{isOpen:u,onRequestClose:b,children:o(Co,{})}),l("div",{className:X.topBar,children:[o(Ke,{title:x("Proxies")}),l("div",{className:X.topBarRight,children:[o("div",{className:X.textFilterContainer,children:o(Gt,{textAtom:Ie,placeholder:x("Search")})}),o(Ee,{label:x("add_proxy"),children:o($,{kind:"minimal",onClick:()=>m(!0),children:o(Ve,{size:16})})}),o(Ee,{label:x("settings"),children:o($,{kind:"minimal",onClick:()=>_(!0),children:o(ko,{size:16})})})]})]}),o("div",{children:r.map(C=>o("div",{className:X.group,children:o(Zr,{name:C,delay:n,apiConfig:s,dispatch:e})},C))}),o(Bn,{items:t}),o("div",{style:{height:60}}),o(on,{dispatch:e,apiConfig:s,proxyProviders:t}),o(ce,{isOpen:a,onRequestClose:y,children:o(ar,{onClickPrimaryButton:()=>O(s),onClickSecondaryButton:y})})]})}const Ro=e=>({apiConfig:se(e),groupNames:Ce(e),proxyProviders:Rt(e),delay:be(e),showModalClosePrevConns:zt(e)}),Io=I(Ro)(So);export{Io as default};
