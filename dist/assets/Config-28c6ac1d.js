import{r as W,R as f,p as g,c as ne,b as t,j as c,s as ae,t as A,v as B,w as re,x as G,d as H,y as le,g as V,z as se,u as oe,A as ie,D as O,E as ce,F as de,G as me,H as ue,J as he,K as pe,L as ve,C as fe,S,N as ge,B as y,O as be,P as ye,Q as ke}from"./index-01af9754.js";import{r as we}from"./logs-3274a869.js";import{S as w}from"./Select-f4ee9c18.js";import{I as x,S as Ce}from"./Input-7b85a9d9.js";import{R as P}from"./rotate-cw-747b701a.js";import{T as _e}from"./trash-2-88b9306a.js";function L(){return L=Object.assign||function(e){for(var s=1;s<arguments.length;s++){var o=arguments[s];for(var r in o)Object.prototype.hasOwnProperty.call(o,r)&&(e[r]=o[r])}return e},L.apply(this,arguments)}function Ne(e,s){if(e==null)return{};var o=Oe(e,s),r,n;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],!(s.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}function Oe(e,s){if(e==null)return{};var o={},r=Object.keys(e),n,a;for(a=0;a<r.length;a++)n=r[a],!(s.indexOf(n)>=0)&&(o[n]=e[n]);return o}var z=W.forwardRef(function(e,s){var o=e.color,r=o===void 0?"currentColor":o,n=e.size,a=n===void 0?24:n,h=Ne(e,["color","size"]);return f.createElement("svg",L({ref:s,xmlns:"http://www.w3.org/2000/svg",width:a,height:a,viewBox:"0 0 24 24",fill:"none",stroke:r,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},h),f.createElement("polyline",{points:"8 17 12 21 16 17"}),f.createElement("line",{x1:"12",y1:"12",x2:"12",y2:"21"}),f.createElement("path",{d:"M20.88 18.09A5 5 0 0 0 18 9h-1.26A8 8 0 1 0 3 16.29"}))});z.propTypes={color:g.string,size:g.oneOfType([g.string,g.number])};z.displayName="DownloadCloud";const Se=z;function j(){return j=Object.assign||function(e){for(var s=1;s<arguments.length;s++){var o=arguments[s];for(var r in o)Object.prototype.hasOwnProperty.call(o,r)&&(e[r]=o[r])}return e},j.apply(this,arguments)}function xe(e,s){if(e==null)return{};var o=Pe(e,s),r,n;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],!(s.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}function Pe(e,s){if(e==null)return{};var o={},r=Object.keys(e),n,a;for(a=0;a<r.length;a++)n=r[a],!(s.indexOf(n)>=0)&&(o[n]=e[n]);return o}var E=W.forwardRef(function(e,s){var o=e.color,r=o===void 0?"currentColor":o,n=e.size,a=n===void 0?24:n,h=xe(e,["color","size"]);return f.createElement("svg",j({ref:s,xmlns:"http://www.w3.org/2000/svg",width:a,height:a,viewBox:"0 0 24 24",fill:"none",stroke:r,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},h),f.createElement("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}),f.createElement("polyline",{points:"16 17 21 12 16 7"}),f.createElement("line",{x1:"21",y1:"12",x2:"9",y2:"12"}))});E.propTypes={color:g.string,size:g.oneOfType([g.string,g.number])};E.displayName="LogOut";const Ie=E,Le="_root_1vck5_4",je="_section_1vck5_5",ze="_wrapSwitch_1vck5_30",Ee="_sep_1vck5_36",Re="_label_1vck5_49",i={root:Le,section:je,wrapSwitch:ze,sep:Ee,label:Re},Te="_fieldset_1hnn2_1",Me="_input_1hnn2_10",$e="_cnt_1hnn2_10",I={fieldset:Te,input:Me,cnt:$e};function De({OptionComponent:e,optionPropsList:s,selectedIndex:o,onChange:r}){const n=ne("visually-hidden",I.input),a=h=>{r(h.target.value)};return t("fieldset",{className:I.fieldset,children:s.map((h,d)=>c("label",{children:[t("input",{type:"radio",checked:o===d,name:"selection",value:d,"aria-labelledby":"traffic chart type "+d,onChange:a,className:n}),t("div",{className:I.cnt,children:t(e,{...h})})]},d))})}const{useMemo:Fe}=G,Ue={plugins:{legend:{display:!1}},scales:{x:{display:!1,type:"category"},y:{display:!1,type:"linear"}}},J=[23e3,35e3,46e3,33e3,9e4,68e3,23e3,45e3],Ae=[184e3,183e3,196e3,182e3,19e4,186e3,182e3,189e3],Be=J;function We({id:e}){const s=ae.read(),o=Fe(()=>({labels:Be,datasets:[{...A,...B[e].up,data:J},{...A,...B[e].down,data:Ae}]}),[e]),r="chart-"+e;return re(s.Chart,r,o,null,Ue),t("div",{style:{width:80,padding:5},children:t("canvas",{id:r})})}const{useEffect:Q,useState:Ge,useCallback:p,useRef:He}=G,Ve=[{id:0},{id:1},{id:2},{id:3}],Je=[["debug","Debug"],["info","Info"],["warning","Warning"],["error","Error"],["silent","Silent"]],Qe=[{key:"port",label:"Http Port"},{key:"socks-port",label:"Socks5 Port"},{key:"mixed-port",label:"Mixed Port"},{key:"redir-port",label:"Redir Port"},{key:"mitm-port",label:"MITM Port"}],Ke=[["zh-cn","简体中文"],["zh-tw","繁體中文"],["en","English"],["vi","Vietnamese"]],qe=[["direct","Direct"],["rule","Rule"],["script","Script"],["global","Global"]],Xe=[["gvisor","gVisor"],["mixed","Mixed"],["system","System"]],Ye=e=>({configs:le(e),apiConfig:V(e)}),Ze=e=>({selectedChartStyleIndex:ye(e),latencyTestUrl:ke(e),apiConfig:V(e)}),et=H(Ze)(at),dt=H(Ye)(tt);function tt({dispatch:e,configs:s,apiConfig:o}){return Q(()=>{e(se(o))},[e,o]),t(et,{configs:s})}function nt(e){return e&&e.meta&&!e.premium?"Clash.Meta ":e&&e.meta&&e.premium?"sing-box ":"Clash Premium"}function at({dispatch:e,configs:s,selectedChartStyleIndex:o,latencyTestUrl:r,apiConfig:n}){var $,D,F,U;const{t:a,i18n:h}=oe(),[d,C]=Ge(s),R=He(s);Q(()=>{R.current!==s&&C(s),R.current=s},[s]);const K=p(()=>{e(ie("apiConfig"))},[e]),_=p((l,m)=>{C({...d,[l]:m})},[d]),T=p((l,m)=>{const v={...d.tun,[l]:m};C({...d,tun:{...v}})},[d]),b=p(({name:l,value:m})=>{switch(l){case"mode":case"log-level":case"allow-lan":case"sniffing":_(l,m),e(O(n,{[l]:m})),l==="log-level"&&we({...n,logLevel:m});break;case"mitm-port":case"redir-port":case"socks-port":case"mixed-port":case"port":if(m!==""){const v=parseInt(m,10);if(v<0||v>65535)return}_(l,m);break;case"enable":case"stack":T(l,m),e(O(n,{tun:{[l]:m}}));break;default:return}},[n,e,_,T]),{selectChartStyleIndex:q,updateAppConfig:M}=ce(),k=p(l=>{const{name:m,value:v}=l.target;switch(m){case"port":case"socks-port":case"mixed-port":case"redir-port":case"mitm-port":{const N=parseInt(v,10);if(N<0||N>65535)return;e(O(n,{[m]:N}));break}case"latencyTestUrl":{M(m,v);break}case"device name":case"interface name":break;default:throw new Error(`unknown input name ${m}`)}},[n,e,M]),X=p(()=>{e(de(n))},[n,e]),Y=p(()=>{e(me(n))},[n,e]),Z=p(()=>{e(ue(n))},[n,e]),ee=p(()=>{e(he(n))},[n,e]),te=p(()=>{e(pe(n))},[n,e]),{data:u}=ve(["/version",n],()=>be("/version",n));return c("div",{children:[t(fe,{title:a("Config")}),c("div",{className:i.root,children:[u.meta&&u.premium||Qe.map(l=>d[l.key]!==void 0?c("div",{children:[t("div",{className:i.label,children:l.label}),t(x,{name:l.key,value:d[l.key],onChange:({target:{name:m,value:v}})=>b({name:m,value:v}),onBlur:k})]},l.key):null),c("div",{children:[t("div",{className:i.label,children:"Mode"}),t(w,{options:d["mode-list"]?d["mode-list"].map(l=>[l,l]):qe,selected:d["mode-list"]?d.mode:d.mode.toLowerCase(),onChange:l=>b({name:"mode",value:l.target.value})})]}),c("div",{children:[t("div",{className:i.label,children:"Log Level"}),t(w,{options:Je,selected:d["log-level"].toLowerCase(),onChange:l=>b({name:"log-level",value:l.target.value})})]}),u.meta&&u.premium||c("div",{children:[t("div",{className:i.label,children:a("allow_lan")}),t("div",{className:i.wrapSwitch,children:t(S,{name:"allow-lan",checked:d["allow-lan"],onChange:l=>b({name:"allow-lan",value:l})})})]}),u.meta&&!u.premium&&c("div",{children:[t("div",{className:i.label,children:a("tls_sniffing")}),t("div",{className:i.wrapSwitch,children:t(S,{name:"sniffing",checked:d.sniffing,onChange:l=>b({name:"sniffing",value:l})})})]})]}),t("div",{className:i.sep,children:t("div",{})}),u.meta&&c(ge,{children:[u.premium||c("div",{children:[c("div",{className:i.section,children:[c("div",{children:[t("div",{className:i.label,children:a("enable_tun_device")}),t("div",{className:i.wrapSwitch,children:t(S,{checked:($=d.tun)==null?void 0:$.enable,onChange:l=>b({name:"enable",value:l})})})]}),c("div",{children:[t("div",{className:i.label,children:"TUN IP Stack"}),t(w,{options:Xe,selected:(F=(D=d.tun)==null?void 0:D.stack)==null?void 0:F.toLowerCase(),onChange:l=>b({name:"stack",value:l.target.value})})]}),c("div",{children:[t("div",{className:i.label,children:"Device Name"}),t(x,{name:"device name",value:(U=d.tun)==null?void 0:U.device,onChange:k})]}),c("div",{children:[t("div",{className:i.label,children:"Interface Name"}),t(x,{name:"interface name",value:d["interface-name"]||"",onChange:k})]})]}),t("div",{className:i.sep,children:t("div",{})})]}),c("div",{className:i.section,children:[c("div",{children:[t("div",{className:i.label,children:"Reload"}),t(y,{start:t(P,{size:16}),label:a("reload_config_file"),onClick:X})]}),u.meta&&!u.premium&&c("div",{children:[t("div",{className:i.label,children:"GEO Databases"}),t(y,{start:t(Se,{size:16}),label:a("update_geo_databases_file"),onClick:ee})]}),c("div",{children:[t("div",{className:i.label,children:"FakeIP"}),t(y,{start:t(_e,{size:16}),label:a("flush_fake_ip_pool"),onClick:te})]}),u.meta&&!u.premium&&c("div",{children:[t("div",{className:i.label,children:"Restart"}),t(y,{start:t(P,{size:16}),label:a("restart_core"),onClick:Y})]}),u.meta&&!u.premium&&c("div",{children:[t("div",{className:i.label,children:"⚠️ Upgrade ⚠️"}),t(y,{start:t(P,{size:16}),label:a("upgrade_core"),onClick:Z})]})]}),t("div",{className:i.sep,children:t("div",{})})]}),c("div",{className:i.section,children:[c("div",{children:[t("div",{className:i.label,children:a("latency_test_url")}),t(Ce,{name:"latencyTestUrl",type:"text",value:r,onBlur:k})]}),c("div",{children:[t("div",{className:i.label,children:a("lang")}),t("div",{children:t(w,{options:Ke,selected:h.language,onChange:l=>h.changeLanguage(l.target.value)})})]}),c("div",{children:[t("div",{className:i.label,children:a("chart_style")}),t(De,{OptionComponent:We,optionPropsList:Ve,selectedIndex:o,onChange:q})]}),c("div",{children:[c("div",{className:i.label,children:[a("current_backend"),t("p",{children:nt(u)+(n==null?void 0:n.baseURL)})]}),t("div",{className:i.label,children:"Action"}),t(y,{start:t(Ie,{size:16}),label:a("switch_backend"),onClick:K})]})]})]})}export{dt as default};
