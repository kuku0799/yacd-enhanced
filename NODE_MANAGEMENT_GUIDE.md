# 节点管理模块使用指南

## 概述

节点管理模块是Yacd Enhanced项目的一个新功能，允许用户通过Web界面直接管理OpenClash的节点，无需手动编辑文件。

## 功能特性

### 🎯 核心功能
- **可视化节点管理**: 通过Web界面添加、删除、查看节点
- **多协议支持**: 支持VMess、SS、Trojan、VLESS协议
- **智能验证**: 自动验证节点格式，过滤无效节点
- **实时统计**: 显示节点类型分布和总数统计
- **文件导入导出**: 支持从文件导入节点，导出节点列表

### 📊 节点统计
- 总节点数统计
- 各协议节点数量统计（VMess、SS、Trojan、VLESS）
- 节点状态跟踪（成功、失败、处理中）

### 🔧 操作功能
- **添加节点**: 手动输入或批量导入节点链接
- **删除节点**: 单个删除或清空所有节点
- **导入导出**: 支持txt文件导入和导出
- **实时更新**: 一键触发节点更新到OpenClash

## 使用方法

### 1. 访问节点管理界面
```
http://您的路由器IP:9090/ui/yacd/
```
在监控面板中选择"节点管理"标签页。

### 2. 添加节点

#### 方法一：手动输入
1. 在文本框中粘贴节点链接，每行一个
2. 点击"添加节点"按钮
3. 系统会自动验证节点格式并添加到列表

#### 方法二：文件导入
1. 点击"导入文件"按钮
2. 选择包含节点链接的txt文件
3. 文件内容会自动加载到输入框
4. 点击"添加节点"完成导入

### 3. 管理节点

#### 查看节点列表
- 节点按类型显示不同颜色的标签
- 显示节点预览（长链接会被截断）
- 显示节点状态（成功/失败/处理中）

#### 删除节点
- 点击节点右侧的"删除"按钮删除单个节点
- 点击"清空所有"按钮删除所有节点

#### 导出节点
- 点击"导出节点"按钮下载当前节点列表为txt文件

### 4. 更新节点
- 点击"立即更新节点"按钮触发节点更新
- 系统会自动调用Python脚本更新OpenClash配置

## 支持的节点格式

### VMess
```
vmess://base64编码的配置
```

### Shadowsocks
```
ss://base64编码的配置
```

### Trojan
```
trojan://密码@服务器:端口?security=tls&type=tcp#备注
```

### VLESS
```
vless://uuid@服务器:端口?encryption=none&security=tls&type=tcp#备注
```

## 技术实现

### 前端组件
- `NodeManager.tsx`: 主要的节点管理组件
- `NodeManager.css`: 样式文件
- `nodes.ts`: API接口封装

### 后端服务
- `NodeService.ts`: 节点处理逻辑
- 节点验证和格式化
- 统计信息计算

### 核心功能
1. **节点验证**: 自动检测节点协议类型
2. **格式处理**: 清理和格式化节点内容
3. **去重处理**: 自动去除重复节点
4. **统计计算**: 实时计算节点类型分布

## 配置说明

### 文件路径配置
```typescript
const nodeService = new NodeService({
  nodesFilePath: '/root/OpenClashManage/wangluo/nodes.txt',
  logFilePath: '/root/OpenClashManage/wangluo/log.txt'
});
```

### API端点
- `POST /api/nodes`: 保存节点
- `DELETE /api/nodes`: 删除所有节点
- `POST /api/nodes/update`: 触发节点更新

## 错误处理

### 常见错误
1. **节点格式错误**: 系统会自动过滤无效节点
2. **网络连接失败**: 显示错误状态，可重试
3. **文件权限问题**: 检查文件路径和权限设置

### 故障排除
1. 确保Python脚本路径正确
2. 检查文件读写权限
3. 验证OpenClash服务状态

## 最佳实践

### 节点管理
1. 定期清理无效节点
2. 使用有意义的节点名称
3. 备份重要的节点列表

### 性能优化
1. 避免一次性添加过多节点
2. 定期清理重复节点
3. 监控节点更新日志

## 更新日志

### v1.0.0
- 初始版本发布
- 支持基本的节点管理功能
- 集成到Yacd Enhanced项目

## 技术支持

如遇到问题，请检查：
1. 节点格式是否正确
2. 网络连接是否正常
3. 系统日志中的错误信息

更多帮助请参考项目文档或提交Issue。 